<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>SPEC CPU2006安装使用避坑 | Memos</title>
<meta name=keywords content><meta name=description content="安装

网上找到的版本应该是这个speccpu2006-v1.0.1-newest.tar，在想要安装的目录下执行tar -xvf speccpu2006-v1.0.1-newest.tar就可以解压安装
进入到目录里面cd speccpu2006-v1.0.1
安装 spec ，./install.sh，如果安装出现错误，极有可能是有一些文件没有可执行文件，递归赋予可执行文件就行chmod -R a+x .，不会有问题的
安装完成之后执行./shrc激活spec环境（以后每次重新打开一个 shell 会话的时候都需要激活一下）

构成

SPEC有两个部分组成，一个是数据，一个是代码（代码以项目的方式组织），运行需要指定数据以及项目
数据有三个规格

test（小型）
train（中型）
ref（大型）


代码有以下选项

int（整型运算性能）
float，也叫 fp（浮点运算性能）
all_c（全部 c 项目）
all_cpp（全部 cpp 项目）
all（全部项目）
特定项目，比如 453.povray



编译标准

C 语言要使用 -std=gnu89
CPP 要使用 -std=c++98
如果要启用 address sanitizer，要注意防止 sanitizer 检测到错误的时候 abort 程序而导致 benchmark 提前终止，需要使用以下编译选项


1


-fsanitize=address -fsanitize-recover=address


并且要注入环境变量ASAN_OPTIONS=halt_on_error=0:detect_leaks=0

配制
运行 spec 需要指定配制，在配制文件里面要声明 reportable = 1 才可以有结果输出
运行模式
spec 有两种运行模式，一个是 base ，基本模式，一般使用这个，一个是 peak ，性能模式，测试峰值性能极限"><meta name=author content="HCY"><link rel=canonical href=https://hcy-asleep.github.io/SPEC-CPU2006%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E9%81%BF%E5%9D%91/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bbe7c693ba1e57651eda5c9f7653fe0f608bca43c4b67d413bde2747e48dd912.css integrity="sha256-u+fGk7oeV2Ue2lyfdlP+D2CLykPEtn1BO94nR+SN2RI=" rel="preload stylesheet" as=style><link rel=icon href=https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png><link rel=icon type=image/png sizes=16x16 href=https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png><link rel=icon type=image/png sizes=32x32 href=https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png><link rel=apple-touch-icon href=https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png><link rel=mask-icon href=https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://hcy-asleep.github.io/SPEC-CPU2006%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E9%81%BF%E5%9D%91/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><style>@media screen and (min-width:1px){.post-content input[type=checkbox]:checked~label>img{transform:scale(1.6);cursor:zoom-out;position:relative;z-index:999}.post-content img.zoomCheck{transition:transform .15s ease;z-index:999;cursor:zoom-in}}</style><meta property="og:title" content="SPEC CPU2006安装使用避坑"><meta property="og:description" content="安装

网上找到的版本应该是这个speccpu2006-v1.0.1-newest.tar，在想要安装的目录下执行tar -xvf speccpu2006-v1.0.1-newest.tar就可以解压安装
进入到目录里面cd speccpu2006-v1.0.1
安装 spec ，./install.sh，如果安装出现错误，极有可能是有一些文件没有可执行文件，递归赋予可执行文件就行chmod -R a+x .，不会有问题的
安装完成之后执行./shrc激活spec环境（以后每次重新打开一个 shell 会话的时候都需要激活一下）

构成

SPEC有两个部分组成，一个是数据，一个是代码（代码以项目的方式组织），运行需要指定数据以及项目
数据有三个规格

test（小型）
train（中型）
ref（大型）


代码有以下选项

int（整型运算性能）
float，也叫 fp（浮点运算性能）
all_c（全部 c 项目）
all_cpp（全部 cpp 项目）
all（全部项目）
特定项目，比如 453.povray



编译标准

C 语言要使用 -std=gnu89
CPP 要使用 -std=c++98
如果要启用 address sanitizer，要注意防止 sanitizer 检测到错误的时候 abort 程序而导致 benchmark 提前终止，需要使用以下编译选项


1


-fsanitize=address -fsanitize-recover=address


并且要注入环境变量ASAN_OPTIONS=halt_on_error=0:detect_leaks=0

配制
运行 spec 需要指定配制，在配制文件里面要声明 reportable = 1 才可以有结果输出
运行模式
spec 有两种运行模式，一个是 base ，基本模式，一般使用这个，一个是 peak ，性能模式，测试峰值性能极限"><meta property="og:type" content="article"><meta property="og:url" content="https://hcy-asleep.github.io/SPEC-CPU2006%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E9%81%BF%E5%9D%91/"><meta property="og:image" content="https://hcy-asleep.github.io/"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-11-17T21:34:26+00:00"><meta property="article:modified_time" content="2024-11-17T21:34:26+00:00"><meta property="og:site_name" content="HCY-BLOGS"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://hcy-asleep.github.io/"><meta name=twitter:title content="SPEC CPU2006安装使用避坑"><meta name=twitter:description content="安装

网上找到的版本应该是这个speccpu2006-v1.0.1-newest.tar，在想要安装的目录下执行tar -xvf speccpu2006-v1.0.1-newest.tar就可以解压安装
进入到目录里面cd speccpu2006-v1.0.1
安装 spec ，./install.sh，如果安装出现错误，极有可能是有一些文件没有可执行文件，递归赋予可执行文件就行chmod -R a+x .，不会有问题的
安装完成之后执行./shrc激活spec环境（以后每次重新打开一个 shell 会话的时候都需要激活一下）

构成

SPEC有两个部分组成，一个是数据，一个是代码（代码以项目的方式组织），运行需要指定数据以及项目
数据有三个规格

test（小型）
train（中型）
ref（大型）


代码有以下选项

int（整型运算性能）
float，也叫 fp（浮点运算性能）
all_c（全部 c 项目）
all_cpp（全部 cpp 项目）
all（全部项目）
特定项目，比如 453.povray



编译标准

C 语言要使用 -std=gnu89
CPP 要使用 -std=c++98
如果要启用 address sanitizer，要注意防止 sanitizer 检测到错误的时候 abort 程序而导致 benchmark 提前终止，需要使用以下编译选项


1


-fsanitize=address -fsanitize-recover=address


并且要注入环境变量ASAN_OPTIONS=halt_on_error=0:detect_leaks=0

配制
运行 spec 需要指定配制，在配制文件里面要声明 reportable = 1 才可以有结果输出
运行模式
spec 有两种运行模式，一个是 base ，基本模式，一般使用这个，一个是 peak ，性能模式，测试峰值性能极限"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://hcy-asleep.github.io/post/"},{"@type":"ListItem","position":2,"name":"SPEC CPU2006安装使用避坑","item":"https://hcy-asleep.github.io/SPEC-CPU2006%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E9%81%BF%E5%9D%91/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"SPEC CPU2006安装使用避坑","name":"SPEC CPU2006安装使用避坑","description":"安装 网上找到的版本应该是这个speccpu2006-v1.0.1-newest.tar，在想要安装的目录下执行tar -xvf speccpu2006-v1.0.1-newest.tar就可以解压安装 进入到目录里面cd speccpu2006-v1.0.1 安装 spec ，./install.sh，如果安装出现错误，极有可能是有一些文件没有可执行文件，递归赋予可执行文件就行chmod -R a+x .，不会有问题的 安装完成之后执行./shrc激活spec环境（以后每次重新打开一个 shell 会话的时候都需要激活一下） 构成 SPEC有两个部分组成，一个是数据，一个是代码（代码以项目的方式组织），运行需要指定数据以及项目 数据有三个规格 test（小型） train（中型） ref（大型） 代码有以下选项 int（整型运算性能） float，也叫 fp（浮点运算性能） all_c（全部 c 项目） all_cpp（全部 cpp 项目） all（全部项目） 特定项目，比如 453.povray 编译标准 C 语言要使用 -std=gnu89 CPP 要使用 -std=c++98 如果要启用 address sanitizer，要注意防止 sanitizer 检测到错误的时候 abort 程序而导致 benchmark 提前终止，需要使用以下编译选项 1 -fsanitize=address -fsanitize-recover=address 并且要注入环境变量ASAN_OPTIONS=halt_on_error=0:detect_leaks=0 配制 运行 spec 需要指定配制，在配制文件里面要声明 reportable = 1 才可以有结果输出\n运行模式 spec 有两种运行模式，一个是 base ，基本模式，一般使用这个，一个是 peak ，性能模式，测试峰值性能极限\n","keywords":[],"articleBody":"安装 网上找到的版本应该是这个speccpu2006-v1.0.1-newest.tar，在想要安装的目录下执行tar -xvf speccpu2006-v1.0.1-newest.tar就可以解压安装 进入到目录里面cd speccpu2006-v1.0.1 安装 spec ，./install.sh，如果安装出现错误，极有可能是有一些文件没有可执行文件，递归赋予可执行文件就行chmod -R a+x .，不会有问题的 安装完成之后执行./shrc激活spec环境（以后每次重新打开一个 shell 会话的时候都需要激活一下） 构成 SPEC有两个部分组成，一个是数据，一个是代码（代码以项目的方式组织），运行需要指定数据以及项目 数据有三个规格 test（小型） train（中型） ref（大型） 代码有以下选项 int（整型运算性能） float，也叫 fp（浮点运算性能） all_c（全部 c 项目） all_cpp（全部 cpp 项目） all（全部项目） 特定项目，比如 453.povray 编译标准 C 语言要使用 -std=gnu89 CPP 要使用 -std=c++98 如果要启用 address sanitizer，要注意防止 sanitizer 检测到错误的时候 abort 程序而导致 benchmark 提前终止，需要使用以下编译选项 1 -fsanitize=address -fsanitize-recover=address 并且要注入环境变量ASAN_OPTIONS=halt_on_error=0:detect_leaks=0 配制 运行 spec 需要指定配制，在配制文件里面要声明 reportable = 1 才可以有结果输出\n运行模式 spec 有两种运行模式，一个是 base ，基本模式，一般使用这个，一个是 peak ，性能模式，测试峰值性能极限\n关于这两个关键字的解释，要看下文如何看结果报告那一章节 运行命令 1 runspec --rebuild -c $name -a run -I -l --size $size -n $NUM_RUNS $PROJECT --rebuild：每次运行都重新编译，默认行为不是重新编译，而是类似 make -j，另外说一点，spec 使用的不是make，而是specmake -c：指定运行配制（config） -a：指定任务，有以下选项（action）： - build - buildsetup - clean - clobber - configpp - scrub - report - run - setup - trash - validate -I：忽略任何中断 -l：在执行过程中记录输出 --size：选择数据集大小 -n：spec运行的趟数 $PROJECT: Fortran 错误 由于某些项目是有部分使用 fortran 来实现的，所以如果没有安装 gfortran 的时候可能会导致其编译不了，解决方法有二 安装 gfortran 让 FC=echo ，相当于直接告诉它不要编译这部分了，浪费时间的 日志位置 运行完成之后在安装底层目录的 result 文件夹下可以看到运行日志以及结果 看结尾 以 log 结尾的文件是一个完整运行日志，包括编译输出，运行输出，以及结果归纳 以其他文件类型后缀结尾的都是测试结果归纳，只不过文件格式不一样，内容一样的，一般看txt就行 看开头 CINT 表示使用 C/C++ 编写的 int benchmark CFP 表示使用 C/C++ 编写的 float benchmark 看中间 中间是一个编号，遵循以时间为递增的规律 另外在每个项目的文件下也会有单独的编译日志以及运行日志，例如 ls ./benchspec/CPU2006/400.perlbench/run/build_base_1.0000/这个目录下可以看到编译日志 如果这个项目编译出错了，可以在这个目录下找到make.err日志 ls ./benchspec/CPU2006/400.perlbench/run/run_base_test_1.0000/这个目录下可以看到运行日志 看日志 有时候 spec 自带的结果汇总会不完整，因为有些程序有可能被 asan 终止之后在拉起就不被计分了，所有有时候得去日志里面翻找成功运行项目案例的运行时间，在上面提到的那个完整日志里面全局搜索关键字 success 就可以了（忽略大小写）\nlog2excel 脚本，这里是一个简单的将这些 success 项目信息转为 excel 表格的脚本，以及应该喂给这个脚本的 success 数据格式：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 CC = /root/asanopt/llvm-4.0.0-project/build/bin/clang -std=gnu89 -fsanitize=address -fsanitize-recover=address -m64 -g CXX = /root/asanopt/llvm-4.0.0-project/build/bin/clang++ -std=c++98 -fsanitize=address -fsanitize-recover=address -m64 -g 400.perlbench base ref ratio=12.85, runtime=760.415379 400.perlbench base ref ratio=14.33, runtime=681.948309 400.perlbench base ref ratio=14.44, runtime=676.611816 401.bzip2 base ref ratio=18.30, runtime=527.208650 401.bzip2 base ref ratio=18.55, runtime=520.089746 401.bzip2 base ref ratio=18.78, runtime=513.887221 403.gcc base ref ratio=18.22, runtime=441.892276 403.gcc base ref ratio=19.51, runtime=412.592274 403.gcc base ref ratio=19.76, runtime=407.424780 429.mcf base ref ratio=29.58, runtime=308.278307 429.mcf base ref ratio=36.16, runtime=252.184882 429.mcf base ref ratio=38.58, runtime=236.364282 433.milc base ref ratio=20.98, runtime=437.482181 433.milc base ref ratio=21.23, runtime=432.368999 433.milc base ref ratio=21.41, runtime=428.706485 444.namd base ref ratio=19.20, runtime=417.752721 444.namd base ref ratio=19.35, runtime=414.419211 444.namd base ref ratio=20.47, runtime=391.783225 445.gobmk base ref ratio=21.42, runtime=489.668323 445.gobmk base ref ratio=22.60, runtime=464.136214 445.gobmk base ref ratio=22.85, runtime=458.984958 447.dealII base ref ratio=27.67, runtime=413.422023 447.dealII base ref ratio=28.80, runtime=397.228149 447.dealII base ref ratio=30.58, runtime=374.084230 450.soplex base ref ratio=28.75, runtime=290.083530 450.soplex base ref ratio=31.28, runtime=266.656672 450.soplex base ref ratio=32.73, runtime=254.838331 453.povray base ref ratio=20.95, runtime=253.951463 453.povray base ref ratio=21.30, runtime=249.714080 453.povray base ref ratio=22.47, runtime=236.739422 456.hmmer base ref ratio=14.50, runtime=643.463325 456.hmmer base ref ratio=16.22, runtime=575.344854 456.hmmer base ref ratio=16.35, runtime=570.789854 458.sjeng base ref ratio=21.67, runtime=558.318427 458.sjeng base ref ratio=24.55, runtime=492.913527 458.sjeng base ref ratio=25.18, runtime=480.538434 462.libquantum base ref ratio=62.08, runtime=333.748264 462.libquantum base ref ratio=68.76, runtime=301.351093 462.libquantum base ref ratio=73.88, runtime=280.453628 464.h264ref base ref ratio=31.03, runtime=713.099006 464.h264ref base ref ratio=33.94, runtime=652.062848 464.h264ref base ref ratio=35.00, runtime=632.321436 470.lbm base ref ratio=58.00, runtime=236.895693 470.lbm base ref ratio=63.69, runtime=215.746827 470.lbm base ref ratio=64.17, runtime=214.102158 473.astar base ref ratio=17.80, runtime=394.369525 473.astar base ref ratio=18.05, runtime=388.900111 473.astar base ref ratio=18.77, runtime=374.065830 482.sphinx3 base ref ratio=30.24, runtime=644.427922 482.sphinx3 base ref ratio=30.28, runtime=643.674597 482.sphinx3 base ref ratio=32.57, runtime=598.409849 483.xalancbmk base ref ratio=20.32, runtime=339.625837 483.xalancbmk base ref ratio=20.72, runtime=332.940290 483.xalancbmk base ref ratio=21.84, runtime=315.878660 998.specrand base ref ratio=119.83, runtime=0.083455 998.specrand base ref ratio=122.88, runtime=0.081378 998.specrand base ref ratio=123.67, runtime=0.080860 999.specrand base ref ratio=122.42, runtime=0.081687 999.specrand base ref ratio=123.98, runtime=0.080658 999.specrand base ref ratio=124.79, runtime=0.080134 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 import re import sys from statistics import median from openpyxl import Workbook # 检查是否提供了文件名参数 if len(sys.argv) != 2: print(\"用法: python process_data_to_excel.py \u003c文件名\u003e\") sys.exit(1) # 获取用户输入的文件名 filename = sys.argv[1] # 读取文件 try: with open(filename, 'r') as file: data = file.readlines() except FileNotFoundError: print(f\"文件 {filename} 未找到。\") exit() # 跳过前三行 data = data[3:] # 解析数据 results = {} for line in data: line = line.strip() match = re.match(r'(\\d+\\.\\w+)\\s+base\\s+ref\\s+ratio=(\\d+\\.\\d+),\\s+runtime=(\\d+\\.\\d+)', line) if match: name, ratio, runtime = match.groups() if name not in results: results[name] = [[], []] results[name][0].append(float(ratio)) results[name][1].append(float(runtime)) # 创建 Excel 文件 wb = Workbook() ws = wb.active ws.title = \"Results\" # 写入标题行 ws.append([\"Name\", \"Median Ratio\", \"Median Runtime\"]) # 写入数据（保留完整精度） for name, content in results.items(): median_ratio = median(content[0]) median_runtime = median(content[1]) ws.append([name, median_ratio, median_runtime]) # 保存 Excel 文件 output_file = filename+\".xlsx\" wb.save(output_file) print(f\"结果已保存到 {output_file}\") 要找出那些编译不成功的项目，只需要在完整日志里面全局搜索关键字 error building（忽略大小写）\n补充说明：\n999.specrand 999.specrand 这两个项目的数据不重要，因为这两个项目只是验证 spec 环境的完整性的，比如说能不能编译 看结果报告 报告例子（1），从中间分开，可以划分为INT部分和FLOAT部分，这个报告来自于运行结束之后的终端输出：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 Producing Reports mach: default ext: 1 size: test set: int format: raw -\u003e /root/spec2006/result/CINT2006.001.test.rsf format: ASCII -\u003e /root/spec2006/result/CINT2006.001.test.txt format: Screen -\u003e Estimated Estimated Base Base Base Peak Peak Peak Benchmarks Ref. Run Time Ratio Ref. Run Time Ratio -------------- ------ --------- --------- ------ --------- --------- 400.perlbench -- 6.96 -- S 401.bzip2 -- 6.18 -- S 403.gcc -- 1.33 -- S 429.mcf -- 2.05 -- S 445.gobmk -- 19.0 -- S 456.hmmer -- 3.27 -- S 458.sjeng -- 4.78 -- S 462.libquantum -- 0.0351 -- S 464.h264ref -- 14.0 -- S 471.omnetpp -- 393 -- S 473.astar -- 8.30 -- S 483.xalancbmk -- 0.120 -- S Est. SPECint_base2006 -- Est. SPECint2006 Not Run set: fp format: raw -\u003e /root/spec2006/result/CFP2006.001.test.rsf format: ASCII -\u003e /root/spec2006/result/CFP2006.001.test.txt format: Screen -\u003e Estimated Estimated Base Base Base Peak Peak Peak Benchmarks Ref. Run Time Ratio Ref. Run Time Ratio -------------- ------ --------- --------- ------ --------- --------- 410.bwaves NR 416.gamess NR 433.milc -- 6.52 -- S 434.zeusmp NR 435.gromacs NR 436.cactusADM NR 437.leslie3d NR 444.namd -- 9.79 -- S 447.dealII NR 450.soplex -- 0.024 -- S 453.povray -- 0.875 -- S 454.calculix NR 459.GemsFDTD NR 465.tonto NR 470.lbm -- 1.54 -- S 481.wrf NR 482.sphinx3 -- 1.22 -- S Est. SPECfp_base2006 -- Est. SPECfp2006 Not Run 例子（1）里面的INT 部分：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 set: int format: raw -\u003e /root/spec2006/result/CINT2006.001.test.rsf format: ASCII -\u003e /root/spec2006/result/CINT2006.001.test.txt format: Screen -\u003e Estimated Estimated Base Base Base Peak Peak Peak Benchmarks Ref. Run Time Ratio Ref. Run Time Ratio -------------- ------ --------- --------- ------ --------- --------- 400.perlbench -- 6.96 -- S 401.bzip2 -- 6.18 -- S 403.gcc -- 1.33 -- S 429.mcf -- 2.05 -- S 445.gobmk -- 19.0 -- S 456.hmmer -- 3.27 -- S 458.sjeng -- 4.78 -- S 462.libquantum -- 0.0351 -- S 464.h264ref -- 14.0 -- S 471.omnetpp -- 393 -- S 473.astar -- 8.30 -- S 483.xalancbmk -- 0.120 -- S Est. SPECint_base2006 -- Est. SPECint2006 Not Run 例子（1）的FP 部分：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 set: fp format: raw -\u003e /root/spec2006/result/CFP2006.001.test.rsf format: ASCII -\u003e /root/spec2006/result/CFP2006.001.test.txt format: Screen -\u003e Estimated Estimated Base Base Base Peak Peak Peak Benchmarks Ref. Run Time Ratio Ref. Run Time Ratio -------------- ------ --------- --------- ------ --------- --------- 410.bwaves NR 416.gamess NR 433.milc -- 6.52 -- S 434.zeusmp NR 435.gromacs NR 436.cactusADM NR 437.leslie3d NR 444.namd -- 9.79 -- S 447.dealII NR 450.soplex -- 0.024 -- S 453.povray -- 0.875 -- S 454.calculix NR 459.GemsFDTD NR 465.tonto NR 470.lbm -- 1.54 -- S 481.wrf NR 482.sphinx3 -- 1.22 -- S Est. SPECfp_base2006 -- Est. SPECfp2006 Not Run 报告例子（2），这个报告来自CINT的log,已经单独区分出了INT部分，所以不需要再从中间划开区分两部分\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 SPEC(R) CINT2006 Summary -- -- Fri Nov 15 23:02:02 2024 CPU2006 License #0 Test date: -- Hardware availability: -- Test sponsor: -- Software availability: -- Estimated Estimated Base Base Base Peak Peak Peak Benchmarks Ref. Run Time Ratio Ref. Run Time Ratio -------------- ------ --------- --------- ------ --------- --------- 400.perlbench 9770 208 47.0 S 400.perlbench 9770 196 49.8 S 400.perlbench 9770 197 49.5 * 401.bzip2 9650 318 30.4 S 401.bzip2 9650 320 30.2 S 401.bzip2 9650 318 30.3 * 403.gcc 8050 173 46.6 S 403.gcc 8050 165 48.7 * 403.gcc 8050 165 48.8 S 429.mcf 9120 182 50.0 S 429.mcf 9120 176 51.9 * 429.mcf 9120 175 52.0 S 445.gobmk 10490 292 35.9 S 445.gobmk 10490 290 36.2 S 445.gobmk 10490 290 36.2 * 456.hmmer 9330 213 43.9 * 456.hmmer 9330 213 43.8 S 456.hmmer 9330 213 43.9 S 458.sjeng 12100 288 42.0 S 458.sjeng 12100 288 42.0 S 458.sjeng 12100 288 42.0 * 462.libquantum 20720 227 91.3 S 462.libquantum 20720 225 92.0 S 462.libquantum 20720 226 91.7 * 464.h264ref 22130 284 78.0 S 464.h264ref 22130 284 77.8 * 464.h264ref 22130 285 77.7 S 471.omnetpp 6250 239 26.2 S 471.omnetpp 6250 235 26.6 * 471.omnetpp 6250 234 26.7 S 473.astar 7020 263 26.7 S 473.astar 7020 265 26.5 S 473.astar 7020 265 26.5 * 483.xalancbmk 6900 138 49.9 * 483.xalancbmk 6900 138 49.9 S 483.xalancbmk 6900 138 50.0 S ============================================================================== 400.perlbench 9770 197 49.5 * 401.bzip2 9650 318 30.3 * 403.gcc 8050 165 48.7 * 429.mcf 9120 176 51.9 * 445.gobmk 10490 290 36.2 * 456.hmmer 9330 213 43.9 * 458.sjeng 12100 288 42.0 * 462.libquantum 20720 226 91.7 * 464.h264ref 22130 284 77.8 * 471.omnetpp 6250 235 26.6 * 473.astar 7020 265 26.5 * 483.xalancbmk 6900 138 49.9 * Est. SPECint(R)_base2006 44.7 Est. SPECint2006 Not Run 在这个报告（2）里面，每一个子项目都运行了三次，以等号划分线划分开上下两部分，等号上面是每一轮运行每个子项目的情况，等号下面是等号上面每个子项目取所有运行结果的中位数的汇报\n报告（1）以及（2）表头的关键字解释如下：\nBase 和 Peak 的区别在于编译器优化选项的使用： Base： 使用一组严格限制的编译器优化选项。 所有基准测试必须使用相同的优化设置。 更强调结果的可重复性和一致性。 Peak： 可以为每个基准测试单独选择优化选项。 更倾向于追求单个基准的最佳性能。 优化灵活性更高，但可能降低可重复性。 完整解释表格 字段 解释 Base Ref. 官方标准硬件在 Base 配置下的参考运行时间。 Base Run Time 你的系统在 Base 配置下实际运行该基准所需的时间。 Base Ratio 性能比值，Base Ref. / Base Run Time，数值越大表示性能越好。 Peak Ref. 官方标准硬件在 Peak 配置下的参考运行时间（一般等于 Base Ref.）。 Peak Run Time 你的系统在 Peak 配置下实际运行该基准所需的时间。 Peak Ratio 性能比值，Peak Ref. / Peak Run Time，数值越大表示性能越好。 关于 Estimated Based Ratio 这一列后面的状态列举及解释，看报告（2）做辅助理解： S：成功运行 *：成功运行并且被选为中位数 NR：没有运行（Not Run） CE：编译错误（Compile Error） 关于 Patch 有时候 spec 的源码可能有问题，需要自己手动修正错误，修改源码 在这种情况下，将修改过后的spec重新打包再分发是不可以的，在安装这个修改版本的时候会因为 spec 自带的 checksum 而没有办法通过检验 解决方法： 把修改的部分变成 patch 在安装 spec 完成之后再把 patch 给打上去 SPEC 官方链接直达 SPEC CPU 2006 购买 SPEC CPU 2006 官方文档导航 SPEC CPU 2006 安装使用详解，与本文大部分内容重合 SPEC CPU 2006 配制文件选项详解 SPEC CPU 2006 设计哲学与实现方法 SPEC CPU 2006 命令选项详解 SPEC CPU 2006 里面各个子项目的介绍，点击进网页之后拉到最下面，或者搜索关键字“Benchmark Documentation”（忽略大小写） ","wordCount":"1760","inLanguage":"zh","image":"https://hcy-asleep.github.io/","datePublished":"2024-11-17T21:34:26Z","dateModified":"2024-11-17T21:34:26Z","author":{"@type":"Person","name":"HCY"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://hcy-asleep.github.io/SPEC-CPU2006%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E9%81%BF%E5%9D%91/"},"publisher":{"@type":"Organization","name":"Memos","logo":{"@type":"ImageObject","url":"https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://hcy-asleep.github.io/ accesskey=h title="主页 (Alt + H)">主页</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://hcy-asleep.github.io/archives/ title=归档><span>归档</span></a></li><li><a href=https://hcy-asleep.github.io/tags/ title=标签><span>标签</span></a></li><li><a href=https://hcy-asleep.github.io/categories/ title=目录><span>目录</span></a></li><li><a href=https://hcy-asleep.github.io/friends/ title=友链><span>友链</span></a></li><li><a href=https://hcy-asleep.github.io/about/ title=关于><span>关于</span></a></li><li><a href=https://hcy-asleep.github.io/search/ title="🔍 (Alt + /)" accesskey=/><span>🔍</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://hcy-asleep.github.io/>主页</a>&nbsp;»&nbsp;<a href=https://hcy-asleep.github.io/post/>Posts</a></div><h1 class="post-title entry-hint-parent">SPEC CPU2006安装使用避坑</h1><div class=post-meta><span title='2024-11-17 21:34:26 +0000 UTC'>十一月 17, 2024</span>&nbsp;·&nbsp;9 分钟&nbsp;·&nbsp;1760 字&nbsp;·&nbsp;HCY&nbsp;|&nbsp;<a href=https://github.com/HCY-ASLEEP rel="noopener noreferrer" target=_blank> Follow me</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#安装>安装</a></li><li><a href=#构成>构成</a></li><li><a href=#编译标准>编译标准</a></li><li><a href=#配制>配制</a></li><li><a href=#运行模式>运行模式</a></li><li><a href=#运行命令>运行命令</a></li><li><a href=#fortran-错误>Fortran 错误</a></li><li><a href=#日志位置>日志位置</a></li><li><a href=#看日志>看日志</a></li><li><a href=#看结果报告>看结果报告</a></li><li><a href=#关于-patch>关于 Patch</a></li><li><a href=#spec-官方链接直达>SPEC 官方链接直达</a></li></ul></li></ul></li></ul></nav></div></details></div><div class=post-content><h3 id=安装>安装<a hidden class=anchor aria-hidden=true href=#安装>#</a></h3><ul><li>网上找到的版本应该是这个<code>speccpu2006-v1.0.1-newest.tar</code>，在想要安装的目录下执行<code>tar -xvf speccpu2006-v1.0.1-newest.tar</code>就可以解压安装</li><li>进入到目录里面<code>cd speccpu2006-v1.0.1</code></li><li>安装 spec ，<code>./install.sh</code>，如果安装出现错误，极有可能是有一些文件没有可执行文件，递归赋予可执行文件就行<code>chmod -R a+x .</code>，不会有问题的</li><li>安装完成之后执行<code>./shrc</code>激活spec环境（以后每次重新打开一个 shell 会话的时候都需要激活一下）</li></ul><h3 id=构成>构成<a hidden class=anchor aria-hidden=true href=#构成>#</a></h3><ul><li>SPEC有两个部分组成，一个是数据，一个是代码（代码以项目的方式组织），运行需要指定数据以及项目</li><li>数据有三个规格<ol><li><code>test</code>（小型）</li><li><code>train</code>（中型）</li><li><code>ref</code>（大型）</li></ol></li><li>代码有以下选项<ol><li><code>int</code>（整型运算性能）</li><li><code>float</code>，也叫 fp（浮点运算性能）</li><li><code>all_c</code>（全部 c 项目）</li><li><code>all_cpp</code>（全部 cpp 项目）</li><li><code>all</code>（全部项目）</li><li>特定项目，比如 <code>453.povray</code></li></ol></li></ul><h3 id=编译标准>编译标准<a hidden class=anchor aria-hidden=true href=#编译标准>#</a></h3><ul><li>C 语言要使用 <code>-std=gnu89</code></li><li>CPP 要使用 <code>-std=c++98</code></li><li>如果要启用 address sanitizer，要注意防止 sanitizer 检测到错误的时候 abort 程序而导致 benchmark 提前终止，需要使用以下编译选项<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>-fsanitize<span class=o>=</span>address -fsanitize-recover<span class=o>=</span>address
</span></span></code></pre></td></tr></table></div></div>并且要注入环境变量<code>ASAN_OPTIONS=halt_on_error=0:detect_leaks=0</code></li></ul><h3 id=配制>配制<a hidden class=anchor aria-hidden=true href=#配制>#</a></h3><p>运行 spec 需要指定配制，在配制文件里面要声明 <code>reportable = 1</code> 才可以有结果输出</p><h3 id=运行模式>运行模式<a hidden class=anchor aria-hidden=true href=#运行模式>#</a></h3><p>spec 有两种运行模式，一个是 <code>base</code> ，基本模式，一般使用这个，一个是 <code>peak</code> ，性能模式，测试峰值性能极限</p><ul><li>关于这两个关键字的解释，要看下文如何<code>看结果报告</code>那一章节</li></ul><h3 id=运行命令>运行命令<a hidden class=anchor aria-hidden=true href=#运行命令>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>runspec --rebuild -c <span class=nv>$name</span> -a run -I -l --size <span class=nv>$size</span> -n <span class=nv>$NUM_RUNS</span> <span class=nv>$PROJECT</span>
</span></span></code></pre></td></tr></table></div></div><ol><li><code>--rebuild</code>：每次运行都重新编译，默认行为不是重新编译，而是类似 <code>make -j</code>，另外说一点，spec 使用的不是<code>make</code>，而是<code>specmake</code></li><li><code>-c</code>：指定运行配制（config）</li><li><code>-a</code>：指定任务，有以下选项（action）：
<code>- build</code>
<code>- buildsetup</code>
<code>- clean</code>
<code>- clobber</code>
<code>- configpp</code>
<code>- scrub</code>
<code>- report</code>
<code>- run</code>
<code>- setup</code>
<code>- trash</code>
<code>- validate</code></li><li><code>-I</code>：忽略任何中断</li><li><code>-l</code>：在执行过程中记录输出</li><li><code>--size</code>：选择数据集大小 <code>&lt;test | train | ref></code></li><li><code>-n</code>：spec运行的趟数</li><li><code>$PROJECT</code>: <code>&lt;int | fp | all_c | all_cpp | all></code></li></ol><h3 id=fortran-错误>Fortran 错误<a hidden class=anchor aria-hidden=true href=#fortran-错误>#</a></h3><ul><li>由于某些项目是有部分使用 fortran 来实现的，所以如果没有安装 gfortran 的时候可能会导致其编译不了，解决方法有二<ol><li>安装 gfortran</li><li>让 <code>FC=echo</code> ，相当于直接告诉它不要编译这部分了，浪费时间的</li></ol></li></ul><h3 id=日志位置>日志位置<a hidden class=anchor aria-hidden=true href=#日志位置>#</a></h3><ul><li>运行完成之后在安装底层目录的 result 文件夹下可以看到运行日志以及结果<ol><li>看结尾<ul><li>以 log 结尾的文件是一个完整运行日志，包括编译输出，运行输出，以及结果归纳</li><li>以其他文件类型后缀结尾的都是测试结果归纳，只不过文件格式不一样，内容一样的，一般看txt就行</li></ul></li><li>看开头<ul><li><code>CINT</code> 表示使用 C/C++ 编写的 <code>int benchmark</code></li><li><code>CFP</code> 表示使用 C/C++ 编写的 <code>float benchmark</code></li></ul></li><li>看中间<ul><li>中间是一个编号，遵循以时间为递增的规律</li></ul></li></ol></li><li>另外在每个项目的文件下也会有单独的编译日志以及运行日志，例如<ul><li><code>ls ./benchspec/CPU2006/400.perlbench/run/build_base_1.0000/</code>这个目录下可以看到编译日志<ul><li>如果这个项目编译出错了，可以在这个目录下找到<code>make.err</code>日志</li></ul></li><li><code>ls ./benchspec/CPU2006/400.perlbench/run/run_base_test_1.0000/</code>这个目录下可以看到运行日志</li></ul></li></ul><h3 id=看日志>看日志<a hidden class=anchor aria-hidden=true href=#看日志>#</a></h3><ul><li><p>有时候 spec 自带的结果汇总会不完整，因为有些程序有可能被 asan 终止之后在拉起就不被计分了，所有有时候得去日志里面翻找成功运行项目案例的运行时间，在上面提到的那个完整日志里面全局搜索关键字 <code>success</code> 就可以了（忽略大小写）</p><ul><li><p>log2excel 脚本，这里是一个简单的将这些 success 项目信息转为 excel 表格的脚本，以及应该喂给这个脚本的 success 数据格式：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>CC               = /root/asanopt/llvm-4.0.0-project/build/bin/clang    -std=gnu89 -fsanitize=address -fsanitize-recover=address -m64 -g
</span></span><span class=line><span class=cl>CXX              = /root/asanopt/llvm-4.0.0-project/build/bin/clang++  -std=c++98 -fsanitize=address -fsanitize-recover=address -m64 -g
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>400.perlbench base ref ratio=12.85, runtime=760.415379
</span></span><span class=line><span class=cl>400.perlbench base ref ratio=14.33, runtime=681.948309
</span></span><span class=line><span class=cl>400.perlbench base ref ratio=14.44, runtime=676.611816
</span></span><span class=line><span class=cl>401.bzip2 base ref ratio=18.30, runtime=527.208650
</span></span><span class=line><span class=cl>401.bzip2 base ref ratio=18.55, runtime=520.089746
</span></span><span class=line><span class=cl>401.bzip2 base ref ratio=18.78, runtime=513.887221
</span></span><span class=line><span class=cl>403.gcc base ref ratio=18.22, runtime=441.892276
</span></span><span class=line><span class=cl>403.gcc base ref ratio=19.51, runtime=412.592274
</span></span><span class=line><span class=cl>403.gcc base ref ratio=19.76, runtime=407.424780
</span></span><span class=line><span class=cl>429.mcf base ref ratio=29.58, runtime=308.278307
</span></span><span class=line><span class=cl>429.mcf base ref ratio=36.16, runtime=252.184882
</span></span><span class=line><span class=cl>429.mcf base ref ratio=38.58, runtime=236.364282
</span></span><span class=line><span class=cl>433.milc base ref ratio=20.98, runtime=437.482181
</span></span><span class=line><span class=cl>433.milc base ref ratio=21.23, runtime=432.368999
</span></span><span class=line><span class=cl>433.milc base ref ratio=21.41, runtime=428.706485
</span></span><span class=line><span class=cl>444.namd base ref ratio=19.20, runtime=417.752721
</span></span><span class=line><span class=cl>444.namd base ref ratio=19.35, runtime=414.419211
</span></span><span class=line><span class=cl>444.namd base ref ratio=20.47, runtime=391.783225
</span></span><span class=line><span class=cl>445.gobmk base ref ratio=21.42, runtime=489.668323
</span></span><span class=line><span class=cl>445.gobmk base ref ratio=22.60, runtime=464.136214
</span></span><span class=line><span class=cl>445.gobmk base ref ratio=22.85, runtime=458.984958
</span></span><span class=line><span class=cl>447.dealII base ref ratio=27.67, runtime=413.422023
</span></span><span class=line><span class=cl>447.dealII base ref ratio=28.80, runtime=397.228149
</span></span><span class=line><span class=cl>447.dealII base ref ratio=30.58, runtime=374.084230
</span></span><span class=line><span class=cl>450.soplex base ref ratio=28.75, runtime=290.083530
</span></span><span class=line><span class=cl>450.soplex base ref ratio=31.28, runtime=266.656672
</span></span><span class=line><span class=cl>450.soplex base ref ratio=32.73, runtime=254.838331
</span></span><span class=line><span class=cl>453.povray base ref ratio=20.95, runtime=253.951463
</span></span><span class=line><span class=cl>453.povray base ref ratio=21.30, runtime=249.714080
</span></span><span class=line><span class=cl>453.povray base ref ratio=22.47, runtime=236.739422
</span></span><span class=line><span class=cl>456.hmmer base ref ratio=14.50, runtime=643.463325
</span></span><span class=line><span class=cl>456.hmmer base ref ratio=16.22, runtime=575.344854
</span></span><span class=line><span class=cl>456.hmmer base ref ratio=16.35, runtime=570.789854
</span></span><span class=line><span class=cl>458.sjeng base ref ratio=21.67, runtime=558.318427
</span></span><span class=line><span class=cl>458.sjeng base ref ratio=24.55, runtime=492.913527
</span></span><span class=line><span class=cl>458.sjeng base ref ratio=25.18, runtime=480.538434
</span></span><span class=line><span class=cl>462.libquantum base ref ratio=62.08, runtime=333.748264
</span></span><span class=line><span class=cl>462.libquantum base ref ratio=68.76, runtime=301.351093
</span></span><span class=line><span class=cl>462.libquantum base ref ratio=73.88, runtime=280.453628
</span></span><span class=line><span class=cl>464.h264ref base ref ratio=31.03, runtime=713.099006
</span></span><span class=line><span class=cl>464.h264ref base ref ratio=33.94, runtime=652.062848
</span></span><span class=line><span class=cl>464.h264ref base ref ratio=35.00, runtime=632.321436
</span></span><span class=line><span class=cl>470.lbm base ref ratio=58.00, runtime=236.895693
</span></span><span class=line><span class=cl>470.lbm base ref ratio=63.69, runtime=215.746827
</span></span><span class=line><span class=cl>470.lbm base ref ratio=64.17, runtime=214.102158
</span></span><span class=line><span class=cl>473.astar base ref ratio=17.80, runtime=394.369525
</span></span><span class=line><span class=cl>473.astar base ref ratio=18.05, runtime=388.900111
</span></span><span class=line><span class=cl>473.astar base ref ratio=18.77, runtime=374.065830
</span></span><span class=line><span class=cl>482.sphinx3 base ref ratio=30.24, runtime=644.427922
</span></span><span class=line><span class=cl>482.sphinx3 base ref ratio=30.28, runtime=643.674597
</span></span><span class=line><span class=cl>482.sphinx3 base ref ratio=32.57, runtime=598.409849
</span></span><span class=line><span class=cl>483.xalancbmk base ref ratio=20.32, runtime=339.625837
</span></span><span class=line><span class=cl>483.xalancbmk base ref ratio=20.72, runtime=332.940290
</span></span><span class=line><span class=cl>483.xalancbmk base ref ratio=21.84, runtime=315.878660
</span></span><span class=line><span class=cl>998.specrand base ref ratio=119.83, runtime=0.083455
</span></span><span class=line><span class=cl>998.specrand base ref ratio=122.88, runtime=0.081378
</span></span><span class=line><span class=cl>998.specrand base ref ratio=123.67, runtime=0.080860
</span></span><span class=line><span class=cl>999.specrand base ref ratio=122.42, runtime=0.081687
</span></span><span class=line><span class=cl>999.specrand base ref ratio=123.98, runtime=0.080658
</span></span><span class=line><span class=cl>999.specrand base ref ratio=124.79, runtime=0.080134
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>statistics</span> <span class=kn>import</span> <span class=n>median</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>openpyxl</span> <span class=kn>import</span> <span class=n>Workbook</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 检查是否提供了文件名参数</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;用法: python process_data_to_excel.py &lt;文件名&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 获取用户输入的文件名</span>
</span></span><span class=line><span class=cl><span class=n>filename</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 读取文件</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>file</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>FileNotFoundError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;文件 </span><span class=si>{</span><span class=n>filename</span><span class=si>}</span><span class=s2> 未找到。&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>exit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 跳过前三行</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=mi>3</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 解析数据</span>
</span></span><span class=line><span class=cl><span class=n>results</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>line</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;(\d+\.\w+)\s+base\s+ref\s+ratio=(\d+\.\d+),\s+runtime=(\d+\.\d+)&#39;</span><span class=p>,</span> <span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=k>match</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>name</span><span class=p>,</span> <span class=n>ratio</span><span class=p>,</span> <span class=n>runtime</span> <span class=o>=</span> <span class=k>match</span><span class=o>.</span><span class=n>groups</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>name</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>results</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>results</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=p>[[],</span> <span class=p>[]]</span>
</span></span><span class=line><span class=cl>        <span class=n>results</span><span class=p>[</span><span class=n>name</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>float</span><span class=p>(</span><span class=n>ratio</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>results</span><span class=p>[</span><span class=n>name</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>float</span><span class=p>(</span><span class=n>runtime</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 创建 Excel 文件</span>
</span></span><span class=line><span class=cl><span class=n>wb</span> <span class=o>=</span> <span class=n>Workbook</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ws</span> <span class=o>=</span> <span class=n>wb</span><span class=o>.</span><span class=n>active</span>
</span></span><span class=line><span class=cl><span class=n>ws</span><span class=o>.</span><span class=n>title</span> <span class=o>=</span> <span class=s2>&#34;Results&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 写入标题行</span>
</span></span><span class=line><span class=cl><span class=n>ws</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=s2>&#34;Name&#34;</span><span class=p>,</span> <span class=s2>&#34;Median Ratio&#34;</span><span class=p>,</span> <span class=s2>&#34;Median Runtime&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 写入数据（保留完整精度）</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>content</span> <span class=ow>in</span> <span class=n>results</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>median_ratio</span> <span class=o>=</span> <span class=n>median</span><span class=p>(</span><span class=n>content</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>median_runtime</span> <span class=o>=</span> <span class=n>median</span><span class=p>(</span><span class=n>content</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>ws</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>name</span><span class=p>,</span> <span class=n>median_ratio</span><span class=p>,</span> <span class=n>median_runtime</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 保存 Excel 文件</span>
</span></span><span class=line><span class=cl><span class=n>output_file</span> <span class=o>=</span> <span class=n>filename</span><span class=o>+</span><span class=s2>&#34;.xlsx&#34;</span>
</span></span><span class=line><span class=cl><span class=n>wb</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>output_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;结果已保存到 </span><span class=si>{</span><span class=n>output_file</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li></ul></li><li><p>要找出那些编译不成功的项目，只需要在完整日志里面全局搜索关键字 <code>error building</code>（忽略大小写）</p></li><li><p>补充说明：</p><ul><li><code>999.specrand</code> <code>999.specrand</code> 这两个项目的数据不重要，因为这两个项目只是验证 spec 环境的完整性的，比如说能不能编译</li></ul></li></ul><h3 id=看结果报告>看结果报告<a hidden class=anchor aria-hidden=true href=#看结果报告>#</a></h3><ul><li><p>报告例子（1），从中间分开，可以划分为<code>INT</code>部分和<code>FLOAT</code>部分，这个报告来自于运行结束之后的终端输出：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>Producing Reports</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>mach</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ext</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>size</span><span class=p>:</span><span class=w> </span><span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>set</span><span class=p>:</span><span class=w> </span><span class=l>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>format</span><span class=p>:</span><span class=w> </span><span class=l>raw -&gt; /root/spec2006/result/CINT2006.001.test.rsf</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>format</span><span class=p>:</span><span class=w> </span><span class=l>ASCII -&gt; /root/spec2006/result/CINT2006.001.test.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>format</span><span class=p>:</span><span class=w> </span><span class=l>Screen -&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                  </span><span class=l>Estimated                       Estimated</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=l>Base     Base       Base        Peak     Peak       Peak</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>Benchmarks      Ref.   Run Time     Ratio       Ref.   Run Time     Ratio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span>----------- ------ <span class=w> </span>--------- <span class=w> </span>--------- <span class=w>   </span>------ <span class=w> </span>--------- <span class=w> </span>---------<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>400.</span><span class=l>perlbench      --     6.96           -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>401.</span><span class=l>bzip2          --     6.18           -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>403.</span><span class=l>gcc            --     1.33           -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>429.</span><span class=l>mcf            --     2.05           -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>445.</span><span class=l>gobmk          --    19.0            -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>456.</span><span class=l>hmmer          --     3.27           -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>458.</span><span class=l>sjeng          --     4.78           -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>462.</span><span class=l>libquantum     --     0.0351         -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>464.</span><span class=l>h264ref        --    14.0            -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>471.</span><span class=l>omnetpp        --   393              -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>473.</span><span class=l>astar          --     8.30           -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>483.</span><span class=l>xalancbmk      --     0.120          -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=l>Est. SPECint_base2006                   --</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=l>Est. SPECint2006                                                   Not Run</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>set</span><span class=p>:</span><span class=w> </span><span class=l>fp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>format</span><span class=p>:</span><span class=w> </span><span class=l>raw -&gt; /root/spec2006/result/CFP2006.001.test.rsf</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>format</span><span class=p>:</span><span class=w> </span><span class=l>ASCII -&gt; /root/spec2006/result/CFP2006.001.test.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>format</span><span class=p>:</span><span class=w> </span><span class=l>Screen -&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                  </span><span class=l>Estimated                       Estimated</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=l>Base     Base       Base        Peak     Peak       Peak</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>Benchmarks      Ref.   Run Time     Ratio       Ref.   Run Time     Ratio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span>----------- ------ <span class=w> </span>--------- <span class=w> </span>--------- <span class=w>   </span>------ <span class=w> </span>--------- <span class=w> </span>---------<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>410.</span><span class=l>bwaves                                  NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>416.</span><span class=l>gamess                                  NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>433.</span><span class=l>milc           --      6.52          -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>434.</span><span class=l>zeusmp                                  NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>435.</span><span class=l>gromacs                                 NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>436.</span><span class=l>cactusADM                               NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>437.</span><span class=l>leslie3d                                NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>444.</span><span class=l>namd           --      9.79          -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>447.</span><span class=l>dealII                                  NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>450.</span><span class=l>soplex         --      0.024         -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>453.</span><span class=l>povray         --      0.875         -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>454.</span><span class=l>calculix                                NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>459.</span><span class=l>GemsFDTD                                NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>465.</span><span class=l>tonto                                   NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>470.</span><span class=l>lbm            --      1.54          -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>481.</span><span class=l>wrf                                     NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>482.</span><span class=l>sphinx3        --      1.22          -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=l>Est. SPECfp_base2006                    --</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=l>Est. SPECfp2006                                                    Not Run</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ul><li><p>例子（1）里面的<code>INT</code> 部分：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>      </span><span class=nt>set</span><span class=p>:</span><span class=w> </span><span class=l>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>format</span><span class=p>:</span><span class=w> </span><span class=l>raw -&gt; /root/spec2006/result/CINT2006.001.test.rsf</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>format</span><span class=p>:</span><span class=w> </span><span class=l>ASCII -&gt; /root/spec2006/result/CINT2006.001.test.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>format</span><span class=p>:</span><span class=w> </span><span class=l>Screen -&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                  </span><span class=l>Estimated                       Estimated</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=l>Base     Base       Base        Peak     Peak       Peak</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>Benchmarks      Ref.   Run Time     Ratio       Ref.   Run Time     Ratio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span>----------- ------ <span class=w> </span>--------- <span class=w> </span>--------- <span class=w>   </span>------ <span class=w> </span>--------- <span class=w> </span>---------<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>400.</span><span class=l>perlbench      --     6.96           -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>401.</span><span class=l>bzip2          --     6.18           -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>403.</span><span class=l>gcc            --     1.33           -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>429.</span><span class=l>mcf            --     2.05           -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>445.</span><span class=l>gobmk          --    19.0            -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>456.</span><span class=l>hmmer          --     3.27           -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>458.</span><span class=l>sjeng          --     4.78           -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>462.</span><span class=l>libquantum     --     0.0351         -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>464.</span><span class=l>h264ref        --    14.0            -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>471.</span><span class=l>omnetpp        --   393              -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>473.</span><span class=l>astar          --     8.30           -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>483.</span><span class=l>xalancbmk      --     0.120          -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=l>Est. SPECint_base2006                   --</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=l>Est. SPECint2006                                                   Not Run</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>例子（1）的<code>FP</code> 部分：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>      </span><span class=nt>set</span><span class=p>:</span><span class=w> </span><span class=l>fp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>format</span><span class=p>:</span><span class=w> </span><span class=l>raw -&gt; /root/spec2006/result/CFP2006.001.test.rsf</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>format</span><span class=p>:</span><span class=w> </span><span class=l>ASCII -&gt; /root/spec2006/result/CFP2006.001.test.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>format</span><span class=p>:</span><span class=w> </span><span class=l>Screen -&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                  </span><span class=l>Estimated                       Estimated</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=l>Base     Base       Base        Peak     Peak       Peak</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>Benchmarks      Ref.   Run Time     Ratio       Ref.   Run Time     Ratio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span>----------- ------ <span class=w> </span>--------- <span class=w> </span>--------- <span class=w>   </span>------ <span class=w> </span>--------- <span class=w> </span>---------<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>410.</span><span class=l>bwaves                                  NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>416.</span><span class=l>gamess                                  NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>433.</span><span class=l>milc           --      6.52          -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>434.</span><span class=l>zeusmp                                  NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>435.</span><span class=l>gromacs                                 NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>436.</span><span class=l>cactusADM                               NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>437.</span><span class=l>leslie3d                                NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>444.</span><span class=l>namd           --      9.79          -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>447.</span><span class=l>dealII                                  NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>450.</span><span class=l>soplex         --      0.024         -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>453.</span><span class=l>povray         --      0.875         -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>454.</span><span class=l>calculix                                NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>459.</span><span class=l>GemsFDTD                                NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>465.</span><span class=l>tonto                                   NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>470.</span><span class=l>lbm            --      1.54          -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>481.</span><span class=l>wrf                                     NR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>482.</span><span class=l>sphinx3        --      1.22          -- S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=l>Est. SPECfp_base2006                    --</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=l>Est. SPECfp2006                                                    Not Run</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ul></li><li><p>报告例子（2），这个报告来自<code>CINT</code>的log,已经单独区分出了<code>INT</code>部分，所以不需要再从中间划开区分两部分</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>                   </span><span class=l>SPEC(R) CINT2006 Summary</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                    </span>-- --<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                           </span><span class=l>Fri Nov 15 23:02:02 2024</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>CPU2006 License #0     Test date: --           Hardware availability</span><span class=p>:</span><span class=w> </span>--<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>Test sponsor: --                               Software availability</span><span class=p>:</span><span class=w> </span>--<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                  </span><span class=l>Estimated                       Estimated</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=l>Base     Base       Base        Peak     Peak       Peak</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>Benchmarks      Ref.   Run Time     Ratio       Ref.   Run Time     Ratio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span>----------- ------ <span class=w> </span>--------- <span class=w> </span>--------- <span class=w>   </span>------ <span class=w> </span>--------- <span class=w> </span>---------<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>400.</span><span class=l>perlbench    9770        208       47.0 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>400.</span><span class=l>perlbench    9770        196       49.8 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>400.</span><span class=l>perlbench    9770        197       49.5 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>401.</span><span class=l>bzip2        9650        318       30.4 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>401.</span><span class=l>bzip2        9650        320       30.2 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>401.</span><span class=l>bzip2        9650        318       30.3 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>403.</span><span class=l>gcc          8050        173       46.6 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>403.</span><span class=l>gcc          8050        165       48.7 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>403.</span><span class=l>gcc          8050        165       48.8 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>429.</span><span class=l>mcf          9120        182       50.0 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>429.</span><span class=l>mcf          9120        176       51.9 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>429.</span><span class=l>mcf          9120        175       52.0 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>445.</span><span class=l>gobmk       10490        292       35.9 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>445.</span><span class=l>gobmk       10490        290       36.2 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>445.</span><span class=l>gobmk       10490        290       36.2 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>456.</span><span class=l>hmmer        9330        213       43.9 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>456.</span><span class=l>hmmer        9330        213       43.8 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>456.</span><span class=l>hmmer        9330        213       43.9 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>458.</span><span class=l>sjeng       12100        288       42.0 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>458.</span><span class=l>sjeng       12100        288       42.0 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>458.</span><span class=l>sjeng       12100        288       42.0 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>462.</span><span class=l>libquantum  20720        227       91.3 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>462.</span><span class=l>libquantum  20720        225       92.0 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>462.</span><span class=l>libquantum  20720        226       91.7 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>464.</span><span class=l>h264ref     22130        284       78.0 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>464.</span><span class=l>h264ref     22130        284       77.8 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>464.</span><span class=l>h264ref     22130        285       77.7 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>471.</span><span class=l>omnetpp      6250        239       26.2 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>471.</span><span class=l>omnetpp      6250        235       26.6 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>471.</span><span class=l>omnetpp      6250        234       26.7 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>473.</span><span class=l>astar        7020        263       26.7 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>473.</span><span class=l>astar        7020        265       26.5 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>473.</span><span class=l>astar        7020        265       26.5 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>483.</span><span class=l>xalancbmk    6900        138       49.9 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>483.</span><span class=l>xalancbmk    6900        138       49.9 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>483.</span><span class=l>xalancbmk    6900        138       50.0 S                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>==============================================================================</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>400.</span><span class=l>perlbench    9770        197       49.5 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>401.</span><span class=l>bzip2        9650        318       30.3 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>403.</span><span class=l>gcc          8050        165       48.7 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>429.</span><span class=l>mcf          9120        176       51.9 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>445.</span><span class=l>gobmk       10490        290       36.2 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>456.</span><span class=l>hmmer        9330        213       43.9 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>458.</span><span class=l>sjeng       12100        288       42.0 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>462.</span><span class=l>libquantum  20720        226       91.7 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>464.</span><span class=l>h264ref     22130        284       77.8 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>471.</span><span class=l>omnetpp      6250        235       26.6 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>473.</span><span class=l>astar        7020        265       26.5 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>483.</span><span class=l>xalancbmk    6900        138       49.9 *                                  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=l>Est. SPECint(R)_base2006              44.7</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=l>Est. SPECint2006                                                   Not Run</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>在这个报告（2）里面，每一个子项目都运行了三次，以等号划分线划分开上下两部分，等号上面是每一轮运行每个子项目的情况，等号下面是等号上面每个子项目取所有运行结果的中位数的汇报</p></li><li><p>报告（1）以及（2）表头的关键字解释如下：</p></li></ul><ol><li><strong>Base</strong> 和 <strong>Peak</strong> 的区别在于编译器优化选项的使用：</li></ol><ul><li><strong>Base</strong>：<ul><li>使用一组严格限制的编译器优化选项。</li><li>所有基准测试必须使用相同的优化设置。</li><li>更强调结果的可重复性和一致性。</li></ul></li><li><strong>Peak</strong>：<ul><li>可以为每个基准测试单独选择优化选项。</li><li>更倾向于追求单个基准的最佳性能。</li><li>优化灵活性更高，但可能降低可重复性。</li></ul></li></ul><ol start=2><li><strong>完整解释表格</strong></li></ol><table><thead><tr><th><strong>字段</strong></th><th><strong>解释</strong></th></tr></thead><tbody><tr><td><strong>Base Ref.</strong></td><td>官方标准硬件在 Base 配置下的参考运行时间。</td></tr><tr><td><strong>Base Run Time</strong></td><td>你的系统在 Base 配置下实际运行该基准所需的时间。</td></tr><tr><td><strong>Base Ratio</strong></td><td>性能比值，<code>Base Ref. / Base Run Time</code>，数值越大表示性能越好。</td></tr><tr><td><strong>Peak Ref.</strong></td><td>官方标准硬件在 Peak 配置下的参考运行时间（一般等于 Base Ref.）。</td></tr><tr><td><strong>Peak Run Time</strong></td><td>你的系统在 Peak 配置下实际运行该基准所需的时间。</td></tr><tr><td><strong>Peak Ratio</strong></td><td>性能比值，<code>Peak Ref. / Peak Run Time</code>，数值越大表示性能越好。</td></tr></tbody></table><ol start=4><li>关于 <code>Estimated Based Ratio</code> 这一列后面的状态列举及解释，看报告（2）做辅助理解：</li></ol><ul><li><code>S</code>：成功运行</li><li><code>*</code>：成功运行并且被选为中位数</li><li><code>NR</code>：没有运行（Not Run）</li><li><code>CE</code>：编译错误（Compile Error）</li></ul><h3 id=关于-patch>关于 Patch<a hidden class=anchor aria-hidden=true href=#关于-patch>#</a></h3><ul><li>有时候 spec 的源码可能有问题，需要自己手动修正错误，修改源码</li><li>在这种情况下，将修改过后的spec重新打包再分发是不可以的，在安装这个修改版本的时候会因为 spec 自带的 checksum 而没有办法通过检验</li><li>解决方法：<ul><li>把修改的部分变成 patch</li><li>在安装 spec 完成之后再把 patch 给打上去</li></ul></li></ul><h3 id=spec-官方链接直达>SPEC 官方链接直达<a hidden class=anchor aria-hidden=true href=#spec-官方链接直达>#</a></h3><ol><li><a href=https://www.spec.org/orderretired.html>SPEC CPU 2006 购买</a></li><li><a href=https://www.spec.org/cpu2006/docs/>SPEC CPU 2006 官方文档导航</a></li><li><a href=https://www.spec.org/cpu2006/docs/install-guide-unix.html>SPEC CPU 2006 安装使用详解，与本文大部分内容重合</a></li><li><a href=https://www.spec.org/cpu2006/docs/config.html>SPEC CPU 2006 配制文件选项详解</a></li><li><a href=https://www.spec.org/cpu2006/docs/runrules.html>SPEC CPU 2006 设计哲学与实现方法</a></li><li><a href=https://www.spec.org/cpu2006/docs/runspec.html>SPEC CPU 2006 <runspec>命令选项详解</a></li><li><a href=https://www.spec.org/cpu2006/docs/>SPEC CPU 2006 里面各个子项目的介绍，点击进网页之后拉到最下面，或者搜索关键字“Benchmark Documentation”（忽略大小写）</a></li></ol></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://hcy-asleep.github.io/Linux%E7%A3%81%E7%9B%98%E5%8D%A0%E7%94%A8%E5%88%86%E6%9E%90/><span class=title>« 上一页</span><br><span>Linux磁盘占用分析</span>
</a><a class=next href=https://hcy-asleep.github.io/Online-LaTex2HTML-Converter-By-Mathjax/><span class=title>下一页 »</span><br><span>Online LaTex2HTML Converter By Mathjax</span></a></nav></footer></br></br><script src=https://giscus.app/client.js data-repo=HCY-ASLEEP/HCY-ASLEEP.github.io data-repo-id=R_kgDOISFjNg data-category=Announcements data-category-id=DIC_kwDOISFjNs4CUJyb data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=zh-CN crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2024 <a href=https://hcy-asleep.github.io/>Memos</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>