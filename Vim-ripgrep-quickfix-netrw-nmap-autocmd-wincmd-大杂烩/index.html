<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Vim ripgrep quickfix netrw nmap autocmd wincmd 。。。大杂烩 ？！ | Memos</title>
<meta name=keywords content="VIM"><meta name=description content="啊，这篇文章就随意一点吧，就意识流地写吧（虽然一直都是这样子），记录一下最近搞 Neovim 的心得
1. 如何使用 nvim + coc 如何滚动悬浮窗口内的内容呢？ 使用 nvim + coc 编写代码的时候，弹出来的悬浮窗口内有滚动条，我怎样才能滚动悬浮窗口内的内容呢？试试 ctrl-w ctrl-w 切换到 floatwin 中，再翻页；更顺手一些的操作是：如果触发 floatwin 的按键是 nmap K, 连按两次 K 就会切换到 floatwin 中
👉 https://segmentfault.com/q/1010000040349668
或者直接映射相关的键位，参考官方 Github 的 Readme
👉 https://github.com/neoclide/coc.nvim/commit/
2. Vim f和t的快捷方式 [ 移动到指定字符 ]
如果我们想在当前行内快速移动，可以使用f, t, F, T命令
&ldquo;f&#34;命令移动到光标右边的指定字符上，例如，&ldquo;fx&rdquo;，会把移动到光标右边的第一个&rsquo;x&rsquo;字符上，&ldquo;F&#34;命令则反方向查找，也就是移动到光标左边的指定字符上
&ldquo;t&#34;命令和&#34;f&#34;命令的区别在于，它移动到光标右边的指定字符之前，例如，&ldquo;tx&#34;会移动到光标右边第一个&rsquo;x&rsquo;字符的前面，&ldquo;T&#34;命令是&#34;t&#34;命令的反向版本，它移动到光标左边的指定字符之后
这四个命令只在当前行中移动光标，光标不会跨越回车换行符
可以在命令前面使用数字，表示倍数，例如，&ldquo;3fx&#34;表示移动到光标右边的第3个&rsquo;x&rsquo;字符上
&ldquo;;&ldquo;命令重复前一次输入的f, t, F, T命令，而&rdquo;,&ldquo;命令会反方向重复前一次输入的f, t, F, T命令，这两个命令前也可以使用数字来表示倍数
👉 https://www.jianshu.com/p/a46a89b460a9
3. 如何在 Vim 里面使用 ripgrep ？ 关于这个问题有两种解决思路：
使用 Vim 里面自带的 quickfix"><meta name=author content="HCY"><link rel=canonical href=https://hcy-asleep.github.io/Vim-ripgrep-quickfix-netrw-nmap-autocmd-wincmd-%E5%A4%A7%E6%9D%82%E7%83%A9/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.b84268f0249a7ffe249d259a826d86a70cb7c15d5b386c020927a792f30b1070.css integrity="sha256-uEJo8CSaf/4knSWagm2Gpwy3wV1bOGwCCSenkvMLEHA=" rel="preload stylesheet" as=style><link rel=icon href=https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png><link rel=icon type=image/png sizes=16x16 href=https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png><link rel=icon type=image/png sizes=32x32 href=https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png><link rel=apple-touch-icon href=https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png><link rel=mask-icon href=https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><style>@media screen and (min-width:1px){.post-content input[type=checkbox]:checked~label>img{transform:scale(1.6);cursor:zoom-out;position:relative;z-index:999}.post-content img.zoomCheck{transition:transform .15s ease;z-index:999;cursor:zoom-in}}</style><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Vim ripgrep quickfix netrw nmap autocmd wincmd 。。。大杂烩 ？！"><meta property="og:description" content="啊，这篇文章就随意一点吧，就意识流地写吧（虽然一直都是这样子），记录一下最近搞 Neovim 的心得
1. 如何使用 nvim + coc 如何滚动悬浮窗口内的内容呢？ 使用 nvim + coc 编写代码的时候，弹出来的悬浮窗口内有滚动条，我怎样才能滚动悬浮窗口内的内容呢？试试 ctrl-w ctrl-w 切换到 floatwin 中，再翻页；更顺手一些的操作是：如果触发 floatwin 的按键是 nmap K, 连按两次 K 就会切换到 floatwin 中
👉 https://segmentfault.com/q/1010000040349668
或者直接映射相关的键位，参考官方 Github 的 Readme
👉 https://github.com/neoclide/coc.nvim/commit/
2. Vim f和t的快捷方式 [ 移动到指定字符 ]
如果我们想在当前行内快速移动，可以使用f, t, F, T命令
&ldquo;f&#34;命令移动到光标右边的指定字符上，例如，&ldquo;fx&rdquo;，会把移动到光标右边的第一个&rsquo;x&rsquo;字符上，&ldquo;F&#34;命令则反方向查找，也就是移动到光标左边的指定字符上
&ldquo;t&#34;命令和&#34;f&#34;命令的区别在于，它移动到光标右边的指定字符之前，例如，&ldquo;tx&#34;会移动到光标右边第一个&rsquo;x&rsquo;字符的前面，&ldquo;T&#34;命令是&#34;t&#34;命令的反向版本，它移动到光标左边的指定字符之后
这四个命令只在当前行中移动光标，光标不会跨越回车换行符
可以在命令前面使用数字，表示倍数，例如，&ldquo;3fx&#34;表示移动到光标右边的第3个&rsquo;x&rsquo;字符上
&ldquo;;&ldquo;命令重复前一次输入的f, t, F, T命令，而&rdquo;,&ldquo;命令会反方向重复前一次输入的f, t, F, T命令，这两个命令前也可以使用数字来表示倍数
👉 https://www.jianshu.com/p/a46a89b460a9
3. 如何在 Vim 里面使用 ripgrep ？ 关于这个问题有两种解决思路：
使用 Vim 里面自带的 quickfix"><meta property="og:type" content="article"><meta property="og:url" content="https://hcy-asleep.github.io/Vim-ripgrep-quickfix-netrw-nmap-autocmd-wincmd-%E5%A4%A7%E6%9D%82%E7%83%A9/"><meta property="og:image" content="https://hcy-asleep.github.io/"><meta property="article:section" content="post"><meta property="article:published_time" content="2023-05-24T13:51:22+08:00"><meta property="article:modified_time" content="2023-05-24T13:51:22+08:00"><meta property="og:site_name" content="HCY-BLOGS"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://hcy-asleep.github.io/"><meta name=twitter:title content="Vim ripgrep quickfix netrw nmap autocmd wincmd 。。。大杂烩 ？！"><meta name=twitter:description content="啊，这篇文章就随意一点吧，就意识流地写吧（虽然一直都是这样子），记录一下最近搞 Neovim 的心得
1. 如何使用 nvim + coc 如何滚动悬浮窗口内的内容呢？ 使用 nvim + coc 编写代码的时候，弹出来的悬浮窗口内有滚动条，我怎样才能滚动悬浮窗口内的内容呢？试试 ctrl-w ctrl-w 切换到 floatwin 中，再翻页；更顺手一些的操作是：如果触发 floatwin 的按键是 nmap K, 连按两次 K 就会切换到 floatwin 中
👉 https://segmentfault.com/q/1010000040349668
或者直接映射相关的键位，参考官方 Github 的 Readme
👉 https://github.com/neoclide/coc.nvim/commit/
2. Vim f和t的快捷方式 [ 移动到指定字符 ]
如果我们想在当前行内快速移动，可以使用f, t, F, T命令
&ldquo;f&#34;命令移动到光标右边的指定字符上，例如，&ldquo;fx&rdquo;，会把移动到光标右边的第一个&rsquo;x&rsquo;字符上，&ldquo;F&#34;命令则反方向查找，也就是移动到光标左边的指定字符上
&ldquo;t&#34;命令和&#34;f&#34;命令的区别在于，它移动到光标右边的指定字符之前，例如，&ldquo;tx&#34;会移动到光标右边第一个&rsquo;x&rsquo;字符的前面，&ldquo;T&#34;命令是&#34;t&#34;命令的反向版本，它移动到光标左边的指定字符之后
这四个命令只在当前行中移动光标，光标不会跨越回车换行符
可以在命令前面使用数字，表示倍数，例如，&ldquo;3fx&#34;表示移动到光标右边的第3个&rsquo;x&rsquo;字符上
&ldquo;;&ldquo;命令重复前一次输入的f, t, F, T命令，而&rdquo;,&ldquo;命令会反方向重复前一次输入的f, t, F, T命令，这两个命令前也可以使用数字来表示倍数
👉 https://www.jianshu.com/p/a46a89b460a9
3. 如何在 Vim 里面使用 ripgrep ？ 关于这个问题有两种解决思路：
使用 Vim 里面自带的 quickfix"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://hcy-asleep.github.io/post/"},{"@type":"ListItem","position":2,"name":"Vim ripgrep quickfix netrw nmap autocmd wincmd 。。。大杂烩 ？！","item":"https://hcy-asleep.github.io/Vim-ripgrep-quickfix-netrw-nmap-autocmd-wincmd-%E5%A4%A7%E6%9D%82%E7%83%A9/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Vim ripgrep quickfix netrw nmap autocmd wincmd 。。。大杂烩 ？！","name":"Vim ripgrep quickfix netrw nmap autocmd wincmd 。。。大杂烩 ？！","description":"啊，这篇文章就随意一点吧，就意识流地写吧（虽然一直都是这样子），记录一下最近搞 Neovim 的心得\n1. 如何使用 nvim + coc 如何滚动悬浮窗口内的内容呢？ 使用 nvim + coc 编写代码的时候，弹出来的悬浮窗口内有滚动条，我怎样才能滚动悬浮窗口内的内容呢？试试 ctrl-w ctrl-w 切换到 floatwin 中，再翻页；更顺手一些的操作是：如果触发 floatwin 的按键是 nmap K, 连按两次 K 就会切换到 floatwin 中\n👉 https://segmentfault.com/q/1010000040349668\n或者直接映射相关的键位，参考官方 Github 的 Readme\n👉 https://github.com/neoclide/coc.nvim/commit/\n2. Vim f和t的快捷方式 [ 移动到指定字符 ]\n如果我们想在当前行内快速移动，可以使用f, t, F, T命令\n\u0026ldquo;f\u0026quot;命令移动到光标右边的指定字符上，例如，\u0026ldquo;fx\u0026rdquo;，会把移动到光标右边的第一个\u0026rsquo;x\u0026rsquo;字符上，\u0026ldquo;F\u0026quot;命令则反方向查找，也就是移动到光标左边的指定字符上\n\u0026ldquo;t\u0026quot;命令和\u0026quot;f\u0026quot;命令的区别在于，它移动到光标右边的指定字符之前，例如，\u0026ldquo;tx\u0026quot;会移动到光标右边第一个\u0026rsquo;x\u0026rsquo;字符的前面，\u0026ldquo;T\u0026quot;命令是\u0026quot;t\u0026quot;命令的反向版本，它移动到光标左边的指定字符之后\n这四个命令只在当前行中移动光标，光标不会跨越回车换行符\n可以在命令前面使用数字，表示倍数，例如，\u0026ldquo;3fx\u0026quot;表示移动到光标右边的第3个\u0026rsquo;x\u0026rsquo;字符上\n\u0026ldquo;;\u0026ldquo;命令重复前一次输入的f, t, F, T命令，而\u0026rdquo;,\u0026ldquo;命令会反方向重复前一次输入的f, t, F, T命令，这两个命令前也可以使用数字来表示倍数\n👉 https://www.jianshu.com/p/a46a89b460a9\n3. 如何在 Vim 里面使用 ripgrep ？ 关于这个问题有两种解决思路：\n使用 Vim 里面自带的 quickfix","keywords":["VIM"],"articleBody":"啊，这篇文章就随意一点吧，就意识流地写吧（虽然一直都是这样子），记录一下最近搞 Neovim 的心得\n1. 如何使用 nvim + coc 如何滚动悬浮窗口内的内容呢？ 使用 nvim + coc 编写代码的时候，弹出来的悬浮窗口内有滚动条，我怎样才能滚动悬浮窗口内的内容呢？试试 ctrl-w ctrl-w 切换到 floatwin 中，再翻页；更顺手一些的操作是：如果触发 floatwin 的按键是 nmap K, 连按两次 K 就会切换到 floatwin 中\n👉 https://segmentfault.com/q/1010000040349668\n或者直接映射相关的键位，参考官方 Github 的 Readme\n👉 https://github.com/neoclide/coc.nvim/commit/\n2. Vim f和t的快捷方式 [ 移动到指定字符 ]\n如果我们想在当前行内快速移动，可以使用f, t, F, T命令\n“f\"命令移动到光标右边的指定字符上，例如，“fx”，会把移动到光标右边的第一个’x’字符上，“F\"命令则反方向查找，也就是移动到光标左边的指定字符上\n“t\"命令和\"f\"命令的区别在于，它移动到光标右边的指定字符之前，例如，“tx\"会移动到光标右边第一个’x’字符的前面，“T\"命令是\"t\"命令的反向版本，它移动到光标左边的指定字符之后\n这四个命令只在当前行中移动光标，光标不会跨越回车换行符\n可以在命令前面使用数字，表示倍数，例如，“3fx\"表示移动到光标右边的第3个’x’字符上\n“;“命令重复前一次输入的f, t, F, T命令，而”,“命令会反方向重复前一次输入的f, t, F, T命令，这两个命令前也可以使用数字来表示倍数\n👉 https://www.jianshu.com/p/a46a89b460a9\n3. 如何在 Vim 里面使用 ripgrep ？ 关于这个问题有两种解决思路：\n使用 Vim 里面自带的 quickfix\n将 rg 搜索结果切割填充到 quickfix 里面，这个部分由 Vim 自己完成，要想使用这个功能，只需要在你的 vimrc 或者 init.vim 里面添加这句话就行\n1 set grepprg=rg\\ --vimgrep\\ --no-heading\\ --smart-case 👉 https://github.com/BurntSushi/ripgrep/issues/425\n👉 https://www.reddit.com/r/vim/comments/\n但是这里有一个问题，就是虽然 rg 搜索速度是非常快的，但是将 rg 搜索结果重定向到 quickfix 里面是非常慢的，因为填充 quickfix 的时候，vimscript 会把每一行切割成一段一段的字符串，然后字典化（也就是给每一段加上 key），以方便文字高亮着色还有后续跳转，在 Vim 普通模式下 :h cexpr 就可以知道原理了\n👉 https://www.reddit.com/r/vim/comments/\n狂热 VIM 爱好者 -\u003e 手搓一个 quickfix\n既然填充的时候切割花费了大量时间，那么我再跳转的时候再切割获得跳转位置信息不久快啦？毕竟切割一行内容多慢都不会慢到哪里去\nVim 获取外部 shell 命令输出结果的方法：\n1 2 3 4 redir =\u003e t:message execute a:cmd redir END echo t:message Vim 将 t:message 的信息填充进 buffer 里面可以使用 setline() 函数\n或者可以直接获取结果然后填充一步到位：\n1 read !ls ~ 👉 https://vim.fandom.com/wiki/Capture_ex_command_output\nVim 在不切换到另外一个窗口下操控另外一个窗口，可以使用 win_execute() 函数，Neovim 也是支持的（nvim 0.7.2 测试可以），用这个函数可以实现 quickfix 里 cNext 那种效果（这里提一嘴，win_execute 里面的 winid 是要通过 win_getid 获取的）\n1 let l:findWinId=win_getid(l:findWinNum) 👉 https://vi.stackexchange.com/questions/23271/\n👉 https://vi.stackexchange.com/questions/26602/\nVim 在 ex （命令模式里面跳转到具体的某行某列）需要使用 cal 命令，如跳转到第 30 行的第 5 列：\n1 cal cursor(30, 5) 👉 https://stackoverflow.com/questions/11767956/\nVim 允许设置 buffer 的文件类型（filetype）：\n1 setlocal filetype=your_type(不用双引号) 打印 buffer 文件类型：\n1 echo \u0026filetype 这个 filetype 属性结合 nnoremap 就可以做到指定某一个 buffer setlocal cursorline (Buffer local mappings in Vim) (vim map in specific window)\n👉 https://stackoverflow.com/questions/7985813/\n我将 rg 整合进 neovim 之后的代码如下：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 \" set ripgrep root dir let g:rgRootDir=getcwd() function! CdCurBufDir() let g:rgRootDir=expand(\"%:p:h\") echo expand(\"%:p:h\") endfunction \" Cc means 'cd cur', cd cur buf dir command! -nargs=1 -complete=command Cc silent call CdCurBufDir() let t:redirPreviewWinnr = 1 function! OpenRedirWindow() let l:findWinNum=bufwinnr(bufnr('FuzzyFilenameSearch')) let l:rgWinNum=bufwinnr(bufnr('RipgrepWordSearch')) if l:findWinNum != -1 exec l:findWinNum.\"wincmd w\" enew elseif l:rgWinNum != -1 exec l:rgWinNum.\"wincmd w\" enew else let t:redirPreviewWinnr = winnr() botright 10new endif endfunction function! QuitRedirWindow() let l:findWinNum=bufwinnr(bufnr('FuzzyFilenameSearch')) let l:rgWinNum=bufwinnr(bufnr('RipgrepWordSearch')) if l:findWinNum != -1 exec l:findWinNum.\"close\" elseif l:rgWinNum != -1 exec l:rgWinNum.\"close\" else echo \"\u003e\u003e No OpenRedirWindow!\" endif endfunction nnoremap \u003csilent\u003e\u003cspace\u003eq :call QuitRedirWindow()\u003cCR\u003e \" Fuzzy Match filenames ----------------------------------------------------------------------------- \" Go to the file on line function! FindJump(path) exec \"cd \".g:rgRootDir let l:path=a:path exec t:redirPreviewWinnr.\"wincmd w\" exec \"edit \".l:path endfunction \" autocmd to jump to file with CR only in FuzzyFilenameSearch buffer function! FindJumpWithCR() augroup findJumpWithCR autocmd! autocmd FileType FuzzyFilenameSearch nnoremap \u003cbuffer\u003e\u003csilent\u003e\u003cCR\u003e :call FindJump(getline('.'))\u003cCR\u003e augroup END endfunction \" redirect the command output to a buffer function! FindRedir(cmd) call FindJumpWithCR() call OpenRedirWindow() edit FuzzyFilenameSearch exec \"read \".a:cmd setlocal buftype=nofile bufhidden=wipe nobuflisted noswapfile cursorline filetype=FuzzyFilenameSearch endfunction command! -nargs=1 -complete=command FindRedir silent call FindRedir(\u003cq-args\u003e) \" Show Files fuzzily searched with git function! FindWithGit(substr) exec \"FindRedir !rg --files \\| rg --ignore-case \".a:substr exec \"normal! gg\" if getline('.') == \"\" exec \"normal! dd\" endif call feedkeys(\"/\".a:substr.\"\\\\c\\\" ,'n') endfunction \" Show Files searched fuzzily without git function! FindWithoutGit(substr) exec \"FindRedir !rg --no-ignore --files \\| rg --ignore-case \".a:substr exec \"normal! gg\" if getline('.') == \"\" exec \"normal! dd\" endif call feedkeys(\"/\".a:substr.\"\\\\c\\\" ,'n') endfunction \" Fg means 'file git', search file names fuzzily with git command! -nargs=1 -complete=command Fg silent call FindWithGit(\u003cq-args\u003e) \" Fs means 'file search', search file names fuzzily command! -nargs=1 -complete=command Fs silent call FindWithoutGit(\u003cq-args\u003e) \" To show file preview, underlying of FindNext, imitate 'cNext' command function! FindShow(direction) let l:findWinNum=bufwinnr(bufnr('FuzzyFilenameSearch')) if l:findWinNum == -1 echo \"\u003e\u003e No FuzzyFilenameSearch Buffer!\" else if l:findWinNum != t:redirPreviewWinnr let l:findWinId=win_getid(l:findWinNum) call win_execute(l:findWinId, \"normal! \".a:direction) call win_execute(l:findWinId, \"let t:findPreviewPath=getline('.')\") call FindJump(t:findPreviewPath) else call FindJump(getline('.')) endif endif endfunction \" imitate 'cNext' function! FindNext() call FindShow(\"+\") endfunction \" imitate 'cprevious' function! FindPre() call FindShow(\"-\") endfunction nnoremap \u003csilent\u003e\u003cC-down\u003e :call FindNext()\u003cCR\u003e nnoremap \u003csilent\u003e\u003cC-up\u003e :call FindPre()\u003cCR\u003e \" Global Fuzzy Match words ------------------------------------------------------------------------- \" Go to the file on line function! RgJump(location) exec \"cd \".g:rgRootDir let l:location = split(a:location, \":\") exec t:redirPreviewWinnr.\"wincmd w\" exec \"edit \".l:location[0] cal cursor(l:location[1], l:location[2]) endfunction \" autocmd to jump to file with CR only in RipgrepWordSearch buffer function! RgJumpWithCR() augroup rgJumpWithCR autocmd! autocmd FileType RipgrepWordSearch nnoremap \u003cbuffer\u003e\u003csilent\u003e\u003cCR\u003e :call RgJump(getline('.'))\u003cCR\u003e augroup END endfunction \" redirect the command output to a buffer function! RgRedir(cmd) call RgJumpWithCR() call OpenRedirWindow() edit RipgrepWordSearch exec \"read \"a:cmd setlocal buftype=nofile bufhidden=wipe nobuflisted noswapfile cursorline filetype=RipgrepWordSearch endfunction command! -nargs=1 -complete=command RgRedir silent call RgRedir(\u003cq-args\u003e) \" Show Words fuzzily searched with git function! RgWithGit(substr) exec \"RgRedir !rg '\".a:substr.\"' \".getcwd().\" --ignore-case --vimgrep --no-heading\" exec \"normal! gg\" if getline('.') == \"\" exec \"normal! dd\" endif call feedkeys(\"/\".a:substr.\"\\\\c\\\" ,'n') endfunction \" Show Files fuzzily searched without git function! RgWithoutGit(substr) exec \"RgRedir !rg '\".a:substr.\"' \".getcwd().\" --ignore-case --vimgrep --no-heading --no-ignore\" exec \"normal! gg\" if getline('.') == \"\" exec \"normal! dd\" endif call feedkeys(\"/\".a:substr.\"\\\\c\\\" ,'n') endfunction \" Wg means 'word git', search file fuzzily names with git command! -nargs=1 -complete=command Wg silent call RgWithGit(\u003cq-args\u003e) \" Ws means 'word search', search file fuzzily names without git command! -nargs=1 -complete=command Ws silent! call RgWithoutGit(\u003cq-args\u003e) \" To show file preview, underlying of RgNext, imitate 'cNext' command function! RgShow(direction) let l:rgWinNum=bufwinnr(bufnr('RipgrepWordSearch')) if l:rgWinNum == -1 echo \"\u003e\u003e No RipgrepWordSearch Buffer!\" else if l:rgWinNum != t:redirPreviewWinnr let l:rgWinId=win_getid(l:rgWinNum) call win_execute(l:rgWinId, \"normal! \".a:direction) call win_execute(l:rgWinId, \"let t:rgPreviewLocation=getline('.')\") call RgJump(t:rgPreviewLocation) else call RgJump(getline('.')) endif endif endfunction \" imitate 'cNext' function! RgNext() call RgShow(\"+\") endfunction \" imitate 'cprevious' function! RgPre() call RgShow(\"-\") endfunction nnoremap \u003csilent\u003e\u003cS-down\u003e :call RgNext()\u003cCR\u003e nnoremap \u003csilent\u003e\u003cS-up\u003e :call RgPre()\u003cCR\u003e 👉 https://github.com/HCY-ASLEEP/NVIM-Config/tree/main\n4. Ripgrep 在线使用手册 一些简单的例子说明：\n👉 https://jdhao.github.io/2020/02/16/ripgrep_cheat_sheet/\nrg 在线 man 手册，没有例子：\n👉 https://www.mankier.com/1/rg\n顺便提一下防止我以后忘记，如果想 rg 搜索结果里面包含隐藏文件（以 ‘.’ 开头的文件），使用 –hidden 参数就可以了\n5. Where is neovim’s .viminfo located? vim 的历史命令文件位于 ~/.viminfo ，而 neovim 的位于\n1 ~/local/share/nvim/shada/main.shada 👉 https://www.reddit.com/r/neovim/comments/\n6. 设置 netrw 的工作目录(root dir) How to set selected directory as current in vim (netrw)? 只需要把光标放在 netrw 里面你想设置的目录下面，然后执行 :Ntree 命令就行\n👉 https://stackoverflow.com/questions/33542513/\n","wordCount":"1113","inLanguage":"zh","datePublished":"2023-05-24T13:51:22+08:00","dateModified":"2023-05-24T13:51:22+08:00","author":{"@type":"Person","name":"HCY"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://hcy-asleep.github.io/Vim-ripgrep-quickfix-netrw-nmap-autocmd-wincmd-%E5%A4%A7%E6%9D%82%E7%83%A9/"},"publisher":{"@type":"Organization","name":"Memos","logo":{"@type":"ImageObject","url":"https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://hcy-asleep.github.io/ accesskey=h title="主页 (Alt + H)">主页</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://hcy-asleep.github.io/archives/ title=归档><span>归档</span></a></li><li><a href=https://hcy-asleep.github.io/tags/ title=标签><span>标签</span></a></li><li><a href=https://hcy-asleep.github.io/categories/ title=目录><span>目录</span></a></li><li><a href=https://hcy-asleep.github.io/friends/ title=友链><span>友链</span></a></li><li><a href=https://hcy-asleep.github.io/about/ title=关于><span>关于</span></a></li><li><a href=https://hcy-asleep.github.io/search/ title="🔍 (Alt + /)" accesskey=/><span>🔍</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://hcy-asleep.github.io/>主页</a>&nbsp;»&nbsp;<a href=https://hcy-asleep.github.io/post/>Posts</a></div><h1 class="post-title entry-hint-parent">Vim ripgrep quickfix netrw nmap autocmd wincmd 。。。大杂烩 ？！</h1><div class=post-meta><span title='2023-05-24 13:51:22 +0800 CST'>五月 24, 2023</span>&nbsp;·&nbsp;6 分钟&nbsp;·&nbsp;1113 字&nbsp;·&nbsp;HCY&nbsp;|&nbsp;<a href=https://github.com/HCY-ASLEEP rel="noopener noreferrer" target=_blank> Follow me</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#1-如何使用-nvim--coc-如何滚动悬浮窗口内的内容呢>1. 如何使用 nvim + coc 如何滚动悬浮窗口内的内容呢？</a></li><li><a href=#2-vim-f和t的快捷方式>2. Vim f和t的快捷方式</a></li><li><a href=#3-如何在-vim-里面使用-ripgrep->3. 如何在 Vim 里面使用 ripgrep ？</a></li><li><a href=#4-ripgrep-在线使用手册>4. Ripgrep 在线使用手册</a></li><li><a href=#5-where-is-neovims-viminfo-located>5. Where is neovim&rsquo;s .viminfo located?</a></li><li><a href=#6-设置-netrw-的工作目录root-dir>6. 设置 netrw 的工作目录(root dir)</a></li></ul></li></ul></li></ul></nav></div></details></div><div class=post-content><p>啊，这篇文章就随意一点吧，就意识流地写吧（虽然一直都是这样子），记录一下最近搞 Neovim 的心得</p><h3 id=1-如何使用-nvim--coc-如何滚动悬浮窗口内的内容呢>1. 如何使用 nvim + coc 如何滚动悬浮窗口内的内容呢？<a hidden class=anchor aria-hidden=true href=#1-如何使用-nvim--coc-如何滚动悬浮窗口内的内容呢>#</a></h3><p>使用 nvim + coc 编写代码的时候，弹出来的悬浮窗口内有滚动条，我怎样才能滚动悬浮窗口内的内容呢？试试 ctrl-w ctrl-w 切换到 floatwin 中，再翻页；更顺手一些的操作是：如果触发 floatwin 的按键是 nmap K, 连按两次 K 就会切换到 floatwin 中</p><p>👉 <a href=https://segmentfault.com/q/1010000040349668>https://segmentfault.com/q/1010000040349668</a></p><p>或者直接映射相关的键位，参考官方 Github 的 Readme</p><p>👉 <a href=https://github.com/neoclide/coc.nvim/commit/624549dab287bd63ef7525d85fbf145669dc3b03>https://github.com/neoclide/coc.nvim/commit/</a></p></br><h3 id=2-vim-f和t的快捷方式>2. Vim f和t的快捷方式<a hidden class=anchor aria-hidden=true href=#2-vim-f和t的快捷方式>#</a></h3><p><strong>[ 移动到指定字符 ]</strong></p><ul><li><p>如果我们想在当前行内快速移动，可以使用f, t, F, T命令</p></li><li><p>&ldquo;f"命令移动到光标右边的指定字符上，例如，&ldquo;fx&rdquo;，会把移动到光标右边的第一个&rsquo;x&rsquo;字符上，&ldquo;F"命令则反方向查找，也就是移动到光标左边的指定字符上</p></li><li><p>&ldquo;t"命令和"f"命令的区别在于，它移动到光标右边的指定字符之前，例如，&ldquo;tx"会移动到光标右边第一个&rsquo;x&rsquo;字符的前面，&ldquo;T"命令是"t"命令的反向版本，它移动到光标左边的指定字符之后</p></li><li><p>这四个命令只在当前行中移动光标，光标不会跨越回车换行符</p></li><li><p>可以在命令前面使用数字，表示倍数，例如，&ldquo;3fx"表示移动到光标右边的第3个&rsquo;x&rsquo;字符上</p></li><li><p>&ldquo;;&ldquo;命令重复前一次输入的f, t, F, T命令，而&rdquo;,&ldquo;命令会反方向重复前一次输入的f, t, F, T命令，这两个命令前也可以使用数字来表示倍数</p></li></ul><p>👉 <a href=https://www.jianshu.com/p/a46a89b460a9>https://www.jianshu.com/p/a46a89b460a9</a></p></br><h3 id=3-如何在-vim-里面使用-ripgrep->3. 如何在 Vim 里面使用 ripgrep ？<a hidden class=anchor aria-hidden=true href=#3-如何在-vim-里面使用-ripgrep->#</a></h3><p>关于这个问题有两种解决思路：</p><ol><li><p><strong>使用 Vim 里面自带的 quickfix</strong></p><ul><li><p>将 rg 搜索结果切割填充到 quickfix 里面，这个部分由 Vim 自己完成，要想使用这个功能，只需要在你的 vimrc 或者 init.vim 里面添加这句话就行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vim data-lang=vim><span class=line><span class=cl><span class=k>set</span> <span class=nx>grepprg</span><span class=p>=</span><span class=nx>rg</span>\ <span class=p>--</span><span class=nx>vimgrep</span>\ <span class=p>--</span><span class=nx>no</span><span class=p>-</span><span class=nx>heading</span>\ <span class=p>--</span><span class=nx>smart</span><span class=p>-</span><span class=nx>case</span>
</span></span></code></pre></td></tr></table></div></div><p>👉 <a href=https://github.com/BurntSushi/ripgrep/issues/425>https://github.com/BurntSushi/ripgrep/issues/425</a></p><p>👉 <a href=https://www.reddit.com/r/vim/comments/1rzvsm/do_any_of_you_redirect_results_of_i_to_the/>https://www.reddit.com/r/vim/comments/</a></p></li><li><p>但是这里有一个问题，就是虽然 rg 搜索速度是非常快的，但是将 rg 搜索结果重定向到 quickfix 里面是非常慢的，因为填充 quickfix 的时候，vimscript 会把每一行切割成一段一段的字符串，然后字典化（也就是给每一段加上 key），以方便文字高亮着色还有后续跳转，在 Vim 普通模式下 :h cexpr 就可以知道原理了</p><p>👉 <a href=https://www.reddit.com/r/vim/comments/e6xw03/ripgrep_is_slow_when_using_grepprg_inside_vim_but/>https://www.reddit.com/r/vim/comments/</a></p></li></ul></li></ol></br><ol start=2><li><p><strong>狂热 VIM 爱好者 -> 手搓一个 quickfix</strong></p><p>既然填充的时候切割花费了大量时间，那么我再跳转的时候再切割获得跳转位置信息不久快啦？毕竟切割一行内容多慢都不会慢到哪里去</p><ul><li><p>Vim 获取外部 shell 命令输出结果的方法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vim data-lang=vim><span class=line><span class=cl><span class=nx>redir</span> <span class=p>=&gt;</span> <span class=nx>t</span>:<span class=nx>message</span>
</span></span><span class=line><span class=cl><span class=k>execute</span> <span class=nx>a</span>:<span class=nx>cmd</span>
</span></span><span class=line><span class=cl><span class=nx>redir</span> <span class=nx>END</span>
</span></span><span class=line><span class=cl><span class=nx>echo</span> <span class=nx>t</span>:<span class=nx>message</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>Vim 将 t:message 的信息填充进 buffer 里面可以使用 setline() 函数</p></li><li><p>或者可以直接获取结果然后填充一步到位：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vim data-lang=vim><span class=line><span class=cl><span class=nx>read</span> <span class=p>!</span><span class=nx>ls</span> <span class=p>~</span>
</span></span></code></pre></td></tr></table></div></div><p>👉 <a href=https://vim.fandom.com/wiki/Capture_ex_command_output>https://vim.fandom.com/wiki/Capture_ex_command_output</a></p></li><li><p>Vim 在不切换到另外一个窗口下操控另外一个窗口，可以使用 win_execute() 函数，Neovim 也是支持的（nvim 0.7.2 测试可以），用这个函数可以实现 quickfix 里 cNext 那种效果（这里提一嘴，win_execute 里面的 winid 是要通过 win_getid 获取的）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vim data-lang=vim><span class=line><span class=cl><span class=k>let</span> <span class=nx>l</span>:<span class=nx>findWinId</span><span class=p>=</span><span class=nx>win_getid</span><span class=p>(</span><span class=nx>l</span>:<span class=nx>findWinNum</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>👉 <a href=https://vi.stackexchange.com/questions/23271/set-option-on-window-without-going-to-the-window-and-come-back>https://vi.stackexchange.com/questions/23271/</a></p><p>👉 <a href=https://vi.stackexchange.com/questions/26602/how-to-scroll-in-another-window-without-switching-to-it>https://vi.stackexchange.com/questions/26602/</a></p></li><li><p>Vim 在 ex （命令模式里面跳转到具体的某行某列）需要使用 cal 命令，如跳转到第 30 行的第 5 列：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vim data-lang=vim><span class=line><span class=cl><span class=nx>cal</span> <span class=nx>cursor</span><span class=p>(</span><span class=m>30</span><span class=p>,</span> <span class=m>5</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>👉 <a href=https://stackoverflow.com/questions/11767956/how-do-i-move-the-cursor-to-a-specific-row-and-column>https://stackoverflow.com/questions/11767956/</a></p></li><li><p>Vim 允许设置 buffer 的文件类型（filetype）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vim data-lang=vim><span class=line><span class=cl><span class=nx>setlocal</span> <span class=k>filetype</span><span class=p>=</span><span class=nx>your_type</span><span class=p>(</span><span class=nx>不用双引号</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>打印 buffer 文件类型：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vim data-lang=vim><span class=line><span class=cl><span class=nx>echo</span> &amp;<span class=k>filetype</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>这个 filetype 属性结合 nnoremap &lt;buffer> 就可以做到指定某一个 buffer setlocal cursorline (Buffer local mappings in Vim) (vim map in specific window)</p><p>👉 <a href=https://stackoverflow.com/questions/7985813/buffer-local-mappings-in-vim-buffer-vs-localleader>https://stackoverflow.com/questions/7985813/</a></p></li><li><p>我将 rg 整合进 neovim 之后的代码如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vim data-lang=vim><span class=line><span class=cl><span class=c>&#34; set ripgrep root dir</span>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nx>g</span>:<span class=nx>rgRootDir</span><span class=p>=</span><span class=nx>getcwd</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>CdCurBufDir</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>let</span> <span class=nx>g</span>:<span class=nx>rgRootDir</span><span class=p>=</span><span class=nx>expand</span><span class=p>(</span><span class=s2>&#34;%:p:h&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>echo</span> <span class=nx>expand</span><span class=p>(</span><span class=s2>&#34;%:p:h&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; Cc means &#39;cd cur&#39;, cd cur buf dir</span>
</span></span><span class=line><span class=cl><span class=nx>command</span><span class=p>!</span> <span class=p>-</span><span class=nx>nargs</span><span class=p>=</span><span class=m>1</span> <span class=p>-</span><span class=nx>complete</span><span class=p>=</span><span class=nx>command</span> <span class=nx>Cc</span> <span class=nx>silent</span> <span class=nx>call</span> <span class=nx>CdCurBufDir</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nx>t</span>:<span class=nx>redirPreviewWinnr</span> <span class=p>=</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>OpenRedirWindow</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>let</span> <span class=nx>l</span>:<span class=nx>findWinNum</span><span class=p>=</span><span class=nx>bufwinnr</span><span class=p>(</span><span class=nx>bufnr</span><span class=p>(</span><span class=s1>&#39;FuzzyFilenameSearch&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>let</span> <span class=nx>l</span>:<span class=nx>rgWinNum</span><span class=p>=</span><span class=nx>bufwinnr</span><span class=p>(</span><span class=nx>bufnr</span><span class=p>(</span><span class=s1>&#39;RipgrepWordSearch&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>l</span>:<span class=nx>findWinNum</span> <span class=p>!=</span> <span class=m>-1</span>
</span></span><span class=line><span class=cl>        <span class=nx>exec</span> <span class=nx>l</span>:<span class=nx>findWinNum</span>.<span class=s2>&#34;wincmd w&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nx>enew</span>
</span></span><span class=line><span class=cl>    <span class=k>elseif</span> <span class=nx>l</span>:<span class=nx>rgWinNum</span> <span class=p>!=</span> <span class=m>-1</span>
</span></span><span class=line><span class=cl>        <span class=nx>exec</span> <span class=nx>l</span>:<span class=nx>rgWinNum</span>.<span class=s2>&#34;wincmd w&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nx>enew</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=k>let</span> <span class=nx>t</span>:<span class=nx>redirPreviewWinnr</span> <span class=p>=</span> <span class=nx>winnr</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=nx>botright</span> <span class=m>10</span>new
</span></span><span class=line><span class=cl>    <span class=k>endif</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>QuitRedirWindow</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>let</span> <span class=nx>l</span>:<span class=nx>findWinNum</span><span class=p>=</span><span class=nx>bufwinnr</span><span class=p>(</span><span class=nx>bufnr</span><span class=p>(</span><span class=s1>&#39;FuzzyFilenameSearch&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>let</span> <span class=nx>l</span>:<span class=nx>rgWinNum</span><span class=p>=</span><span class=nx>bufwinnr</span><span class=p>(</span><span class=nx>bufnr</span><span class=p>(</span><span class=s1>&#39;RipgrepWordSearch&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>l</span>:<span class=nx>findWinNum</span> <span class=p>!=</span> <span class=m>-1</span>
</span></span><span class=line><span class=cl>        <span class=nx>exec</span> <span class=nx>l</span>:<span class=nx>findWinNum</span>.<span class=s2>&#34;close&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>elseif</span> <span class=nx>l</span>:<span class=nx>rgWinNum</span> <span class=p>!=</span> <span class=m>-1</span>
</span></span><span class=line><span class=cl>        <span class=nx>exec</span> <span class=nx>l</span>:<span class=nx>rgWinNum</span>.<span class=s2>&#34;close&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=nx>echo</span> <span class=s2>&#34;&gt;&gt; No OpenRedirWindow!&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>endif</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;&lt;</span><span class=nx>space</span><span class=p>&gt;</span><span class=nx>q</span> :<span class=nx>call</span> <span class=nx>QuitRedirWindow</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; Fuzzy Match filenames -----------------------------------------------------------------------------</span>
</span></span><span class=line><span class=cl><span class=c>&#34; Go to the file on line</span>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>FindJump</span><span class=p>(</span><span class=nx>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>exec</span> <span class=s2>&#34;cd &#34;</span>.<span class=nx>g</span>:<span class=nx>rgRootDir</span>
</span></span><span class=line><span class=cl>    <span class=k>let</span> <span class=nx>l</span>:<span class=nx>path</span><span class=p>=</span><span class=nx>a</span>:<span class=nx>path</span>
</span></span><span class=line><span class=cl>    <span class=nx>exec</span> <span class=nx>t</span>:<span class=nx>redirPreviewWinnr</span>.<span class=s2>&#34;wincmd w&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>exec</span> <span class=s2>&#34;edit &#34;</span>.<span class=nx>l</span>:<span class=nx>path</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; autocmd to jump to file with CR only in FuzzyFilenameSearch buffer</span>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>FindJumpWithCR</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>augroup</span> <span class=nx>findJumpWithCR</span>
</span></span><span class=line><span class=cl>        <span class=k>autocmd</span><span class=p>!</span>
</span></span><span class=line><span class=cl>        <span class=k>autocmd</span> <span class=nx>FileType</span> <span class=nx>FuzzyFilenameSearch</span> <span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>buffer</span><span class=p>&gt;&lt;</span><span class=nx>silent</span><span class=p>&gt;&lt;</span><span class=nx>CR</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=nx>FindJump</span><span class=p>(</span><span class=nx>getline</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>))&lt;</span><span class=nx>CR</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nx>augroup</span> <span class=nx>END</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; redirect the command output to a buffer</span>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>FindRedir</span><span class=p>(</span><span class=nx>cmd</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>call</span> <span class=nx>FindJumpWithCR</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>call</span> <span class=nx>OpenRedirWindow</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>edit</span> <span class=nx>FuzzyFilenameSearch</span>
</span></span><span class=line><span class=cl>    <span class=nx>exec</span> <span class=s2>&#34;read &#34;</span>.<span class=nx>a</span>:<span class=nx>cmd</span>
</span></span><span class=line><span class=cl>    <span class=nx>setlocal</span> <span class=nx>buftype</span><span class=p>=</span><span class=nx>nofile</span> <span class=nx>bufhidden</span><span class=p>=</span><span class=nx>wipe</span> <span class=nx>nobuflisted</span> <span class=nx>noswapfile</span> <span class=nx>cursorline</span> <span class=k>filetype</span><span class=p>=</span><span class=nx>FuzzyFilenameSearch</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>command</span><span class=p>!</span> <span class=p>-</span><span class=nx>nargs</span><span class=p>=</span><span class=m>1</span> <span class=p>-</span><span class=nx>complete</span><span class=p>=</span><span class=nx>command</span> <span class=nx>FindRedir</span> <span class=nx>silent</span> <span class=nx>call</span> <span class=nx>FindRedir</span><span class=p>(&lt;</span><span class=nx>q</span><span class=p>-</span><span class=nx>args</span><span class=p>&gt;)</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; Show Files fuzzily searched with git</span>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>FindWithGit</span><span class=p>(</span><span class=nx>substr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>exec</span> <span class=s2>&#34;FindRedir !rg --files \| rg --ignore-case &#34;</span>.<span class=nx>a</span>:<span class=nx>substr</span>
</span></span><span class=line><span class=cl>    <span class=nx>exec</span> <span class=s2>&#34;normal! gg&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>getline</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>)</span> <span class=p>==</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nx>exec</span> <span class=s2>&#34;normal! dd&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>endif</span>
</span></span><span class=line><span class=cl>    <span class=nx>call</span> <span class=nx>feedkeys</span><span class=p>(</span><span class=s2>&#34;/&#34;</span>.<span class=nx>a</span>:<span class=nx>substr</span>.<span class=s2>&#34;\\c\&lt;CR&gt;&#34;</span> <span class=p>,</span><span class=s1>&#39;n&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; Show Files searched fuzzily without git</span>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>FindWithoutGit</span><span class=p>(</span><span class=nx>substr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>exec</span> <span class=s2>&#34;FindRedir !rg --no-ignore --files \| rg --ignore-case &#34;</span>.<span class=nx>a</span>:<span class=nx>substr</span>
</span></span><span class=line><span class=cl>    <span class=nx>exec</span> <span class=s2>&#34;normal! gg&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>getline</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>)</span> <span class=p>==</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nx>exec</span> <span class=s2>&#34;normal! dd&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>endif</span>
</span></span><span class=line><span class=cl>    <span class=nx>call</span> <span class=nx>feedkeys</span><span class=p>(</span><span class=s2>&#34;/&#34;</span>.<span class=nx>a</span>:<span class=nx>substr</span>.<span class=s2>&#34;\\c\&lt;CR&gt;&#34;</span> <span class=p>,</span><span class=s1>&#39;n&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; Fg means &#39;file git&#39;, search file names fuzzily with git</span>
</span></span><span class=line><span class=cl><span class=nx>command</span><span class=p>!</span> <span class=p>-</span><span class=nx>nargs</span><span class=p>=</span><span class=m>1</span> <span class=p>-</span><span class=nx>complete</span><span class=p>=</span><span class=nx>command</span> <span class=nx>Fg</span> <span class=nx>silent</span> <span class=nx>call</span> <span class=nx>FindWithGit</span><span class=p>(&lt;</span><span class=nx>q</span><span class=p>-</span><span class=nx>args</span><span class=p>&gt;)</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; Fs means &#39;file search&#39;, search file names fuzzily</span>
</span></span><span class=line><span class=cl><span class=nx>command</span><span class=p>!</span> <span class=p>-</span><span class=nx>nargs</span><span class=p>=</span><span class=m>1</span> <span class=p>-</span><span class=nx>complete</span><span class=p>=</span><span class=nx>command</span> <span class=nx>Fs</span> <span class=nx>silent</span> <span class=nx>call</span> <span class=nx>FindWithoutGit</span><span class=p>(&lt;</span><span class=nx>q</span><span class=p>-</span><span class=nx>args</span><span class=p>&gt;)</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; To show file preview, underlying of FindNext, imitate &#39;cNext&#39; command</span>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>FindShow</span><span class=p>(</span><span class=nx>direction</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>let</span> <span class=nx>l</span>:<span class=nx>findWinNum</span><span class=p>=</span><span class=nx>bufwinnr</span><span class=p>(</span><span class=nx>bufnr</span><span class=p>(</span><span class=s1>&#39;FuzzyFilenameSearch&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>l</span>:<span class=nx>findWinNum</span> <span class=p>==</span> <span class=m>-1</span>
</span></span><span class=line><span class=cl>        <span class=nx>echo</span> <span class=s2>&#34;&gt;&gt; No FuzzyFilenameSearch Buffer!&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>l</span>:<span class=nx>findWinNum</span> <span class=p>!=</span> <span class=nx>t</span>:<span class=nx>redirPreviewWinnr</span>
</span></span><span class=line><span class=cl>            <span class=k>let</span> <span class=nx>l</span>:<span class=nx>findWinId</span><span class=p>=</span><span class=nx>win_getid</span><span class=p>(</span><span class=nx>l</span>:<span class=nx>findWinNum</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>call</span> <span class=nx>win_execute</span><span class=p>(</span><span class=nx>l</span>:<span class=nx>findWinId</span><span class=p>,</span> <span class=s2>&#34;normal! &#34;</span>.<span class=nx>a</span>:<span class=nx>direction</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>call</span> <span class=nx>win_execute</span><span class=p>(</span><span class=nx>l</span>:<span class=nx>findWinId</span><span class=p>,</span> <span class=s2>&#34;let t:findPreviewPath=getline(&#39;.&#39;)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>call</span> <span class=nx>FindJump</span><span class=p>(</span><span class=nx>t</span>:<span class=nx>findPreviewPath</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span>
</span></span><span class=line><span class=cl>            <span class=nx>call</span> <span class=nx>FindJump</span><span class=p>(</span><span class=nx>getline</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>endif</span>
</span></span><span class=line><span class=cl>    <span class=k>endif</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; imitate &#39;cNext&#39;</span>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>FindNext</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>call</span> <span class=nx>FindShow</span><span class=p>(</span><span class=s2>&#34;+&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; imitate &#39;cprevious&#39;</span>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>FindPre</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>call</span> <span class=nx>FindShow</span><span class=p>(</span><span class=s2>&#34;-&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;&lt;</span><span class=nx>C</span><span class=p>-</span><span class=nx>down</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=nx>FindNext</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;&lt;</span><span class=nx>C</span><span class=p>-</span><span class=nx>up</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=nx>FindPre</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; Global Fuzzy Match words -------------------------------------------------------------------------</span>
</span></span><span class=line><span class=cl><span class=c>&#34; Go to the file on line</span>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>RgJump</span><span class=p>(</span><span class=nx>location</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>exec</span> <span class=s2>&#34;cd &#34;</span>.<span class=nx>g</span>:<span class=nx>rgRootDir</span>
</span></span><span class=line><span class=cl>    <span class=k>let</span> <span class=nx>l</span>:<span class=nx>location</span> <span class=p>=</span> <span class=nx>split</span><span class=p>(</span><span class=nx>a</span>:<span class=nx>location</span><span class=p>,</span> <span class=s2>&#34;:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>exec</span> <span class=nx>t</span>:<span class=nx>redirPreviewWinnr</span>.<span class=s2>&#34;wincmd w&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>exec</span> <span class=s2>&#34;edit &#34;</span>.<span class=nx>l</span>:<span class=nx>location</span>[<span class=m>0</span>]
</span></span><span class=line><span class=cl>    <span class=nx>cal</span> <span class=nx>cursor</span><span class=p>(</span><span class=nx>l</span>:<span class=nx>location</span>[<span class=m>1</span>]<span class=p>,</span> <span class=nx>l</span>:<span class=nx>location</span>[<span class=m>2</span>]<span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; autocmd to jump to file with CR only in RipgrepWordSearch buffer</span>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>RgJumpWithCR</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>augroup</span> <span class=nx>rgJumpWithCR</span>
</span></span><span class=line><span class=cl>        <span class=k>autocmd</span><span class=p>!</span>
</span></span><span class=line><span class=cl>        <span class=k>autocmd</span> <span class=nx>FileType</span> <span class=nx>RipgrepWordSearch</span> <span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>buffer</span><span class=p>&gt;&lt;</span><span class=nx>silent</span><span class=p>&gt;&lt;</span><span class=nx>CR</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=nx>RgJump</span><span class=p>(</span><span class=nx>getline</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>))&lt;</span><span class=nx>CR</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nx>augroup</span> <span class=nx>END</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; redirect the command output to a buffer</span>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>RgRedir</span><span class=p>(</span><span class=nx>cmd</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>call</span> <span class=nx>RgJumpWithCR</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>call</span> <span class=nx>OpenRedirWindow</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>edit</span> <span class=nx>RipgrepWordSearch</span>
</span></span><span class=line><span class=cl>    <span class=nx>exec</span> <span class=s2>&#34;read &#34;</span><span class=nx>a</span>:<span class=nx>cmd</span>
</span></span><span class=line><span class=cl>    <span class=nx>setlocal</span> <span class=nx>buftype</span><span class=p>=</span><span class=nx>nofile</span> <span class=nx>bufhidden</span><span class=p>=</span><span class=nx>wipe</span> <span class=nx>nobuflisted</span> <span class=nx>noswapfile</span> <span class=nx>cursorline</span> <span class=k>filetype</span><span class=p>=</span><span class=nx>RipgrepWordSearch</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>command</span><span class=p>!</span> <span class=p>-</span><span class=nx>nargs</span><span class=p>=</span><span class=m>1</span> <span class=p>-</span><span class=nx>complete</span><span class=p>=</span><span class=nx>command</span> <span class=nx>RgRedir</span> <span class=nx>silent</span> <span class=nx>call</span> <span class=nx>RgRedir</span><span class=p>(&lt;</span><span class=nx>q</span><span class=p>-</span><span class=nx>args</span><span class=p>&gt;)</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; Show Words fuzzily searched with git</span>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>RgWithGit</span><span class=p>(</span><span class=nx>substr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>exec</span> <span class=s2>&#34;RgRedir !rg &#39;&#34;</span>.<span class=nx>a</span>:<span class=nx>substr</span>.<span class=s2>&#34;&#39; &#34;</span>.<span class=nx>getcwd</span><span class=p>()</span>.<span class=s2>&#34; --ignore-case --vimgrep --no-heading&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>exec</span> <span class=s2>&#34;normal! gg&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>getline</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>)</span> <span class=p>==</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nx>exec</span> <span class=s2>&#34;normal! dd&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>endif</span>
</span></span><span class=line><span class=cl>    <span class=nx>call</span> <span class=nx>feedkeys</span><span class=p>(</span><span class=s2>&#34;/&#34;</span>.<span class=nx>a</span>:<span class=nx>substr</span>.<span class=s2>&#34;\\c\&lt;CR&gt;&#34;</span> <span class=p>,</span><span class=s1>&#39;n&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; Show Files fuzzily searched without git</span>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>RgWithoutGit</span><span class=p>(</span><span class=nx>substr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>exec</span> <span class=s2>&#34;RgRedir !rg &#39;&#34;</span>.<span class=nx>a</span>:<span class=nx>substr</span>.<span class=s2>&#34;&#39; &#34;</span>.<span class=nx>getcwd</span><span class=p>()</span>.<span class=s2>&#34; --ignore-case --vimgrep --no-heading --no-ignore&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>exec</span> <span class=s2>&#34;normal! gg&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>getline</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>)</span> <span class=p>==</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nx>exec</span> <span class=s2>&#34;normal! dd&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>endif</span>
</span></span><span class=line><span class=cl>    <span class=nx>call</span> <span class=nx>feedkeys</span><span class=p>(</span><span class=s2>&#34;/&#34;</span>.<span class=nx>a</span>:<span class=nx>substr</span>.<span class=s2>&#34;\\c\&lt;CR&gt;&#34;</span> <span class=p>,</span><span class=s1>&#39;n&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; Wg means &#39;word git&#39;, search file fuzzily names with git</span>
</span></span><span class=line><span class=cl><span class=nx>command</span><span class=p>!</span> <span class=p>-</span><span class=nx>nargs</span><span class=p>=</span><span class=m>1</span> <span class=p>-</span><span class=nx>complete</span><span class=p>=</span><span class=nx>command</span> <span class=nx>Wg</span> <span class=nx>silent</span> <span class=nx>call</span> <span class=nx>RgWithGit</span><span class=p>(&lt;</span><span class=nx>q</span><span class=p>-</span><span class=nx>args</span><span class=p>&gt;)</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; Ws means &#39;word search&#39;, search file fuzzily names without git</span>
</span></span><span class=line><span class=cl><span class=nx>command</span><span class=p>!</span> <span class=p>-</span><span class=nx>nargs</span><span class=p>=</span><span class=m>1</span> <span class=p>-</span><span class=nx>complete</span><span class=p>=</span><span class=nx>command</span> <span class=nx>Ws</span> <span class=nx>silent</span><span class=p>!</span> <span class=nx>call</span> <span class=nx>RgWithoutGit</span><span class=p>(&lt;</span><span class=nx>q</span><span class=p>-</span><span class=nx>args</span><span class=p>&gt;)</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; To show file preview, underlying of RgNext, imitate &#39;cNext&#39; command</span>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>RgShow</span><span class=p>(</span><span class=nx>direction</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>let</span> <span class=nx>l</span>:<span class=nx>rgWinNum</span><span class=p>=</span><span class=nx>bufwinnr</span><span class=p>(</span><span class=nx>bufnr</span><span class=p>(</span><span class=s1>&#39;RipgrepWordSearch&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>l</span>:<span class=nx>rgWinNum</span> <span class=p>==</span> <span class=m>-1</span>
</span></span><span class=line><span class=cl>        <span class=nx>echo</span> <span class=s2>&#34;&gt;&gt; No RipgrepWordSearch Buffer!&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>l</span>:<span class=nx>rgWinNum</span> <span class=p>!=</span> <span class=nx>t</span>:<span class=nx>redirPreviewWinnr</span>
</span></span><span class=line><span class=cl>            <span class=k>let</span> <span class=nx>l</span>:<span class=nx>rgWinId</span><span class=p>=</span><span class=nx>win_getid</span><span class=p>(</span><span class=nx>l</span>:<span class=nx>rgWinNum</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>call</span> <span class=nx>win_execute</span><span class=p>(</span><span class=nx>l</span>:<span class=nx>rgWinId</span><span class=p>,</span> <span class=s2>&#34;normal! &#34;</span>.<span class=nx>a</span>:<span class=nx>direction</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>call</span> <span class=nx>win_execute</span><span class=p>(</span><span class=nx>l</span>:<span class=nx>rgWinId</span><span class=p>,</span> <span class=s2>&#34;let t:rgPreviewLocation=getline(&#39;.&#39;)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>call</span> <span class=nx>RgJump</span><span class=p>(</span><span class=nx>t</span>:<span class=nx>rgPreviewLocation</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span>
</span></span><span class=line><span class=cl>            <span class=nx>call</span> <span class=nx>RgJump</span><span class=p>(</span><span class=nx>getline</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>endif</span>
</span></span><span class=line><span class=cl>    <span class=k>endif</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; imitate &#39;cNext&#39;</span>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>RgNext</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>call</span> <span class=nx>RgShow</span><span class=p>(</span><span class=s2>&#34;+&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; imitate &#39;cprevious&#39;</span>
</span></span><span class=line><span class=cl><span class=k>function</span><span class=p>!</span> <span class=nx>RgPre</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>call</span> <span class=nx>RgShow</span><span class=p>(</span><span class=s2>&#34;-&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>endfunction</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;&lt;</span><span class=nx>S</span><span class=p>-</span><span class=nx>down</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=nx>RgNext</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;&lt;</span><span class=nx>S</span><span class=p>-</span><span class=nx>up</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=nx>RgPre</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>👉 <a href=https://github.com/HCY-ASLEEP/NVIM-Config/tree/main>https://github.com/HCY-ASLEEP/NVIM-Config/tree/main</a></p></li></ul></li></ol></br><h3 id=4-ripgrep-在线使用手册>4. Ripgrep 在线使用手册<a hidden class=anchor aria-hidden=true href=#4-ripgrep-在线使用手册>#</a></h3><ul><li><p>一些简单的例子说明：</p><p>👉 <a href=https://jdhao.github.io/2020/02/16/ripgrep_cheat_sheet/>https://jdhao.github.io/2020/02/16/ripgrep_cheat_sheet/</a></p></li><li><p>rg 在线 man 手册，没有例子：</p><p>👉 <a href=https://www.mankier.com/1/rg>https://www.mankier.com/1/rg</a></p></li><li><p>顺便提一下防止我以后忘记，如果想 rg 搜索结果里面包含隐藏文件（以 &lsquo;.&rsquo; 开头的文件），使用 &ndash;hidden 参数就可以了</p></li></ul></br><h3 id=5-where-is-neovims-viminfo-located>5. Where is neovim&rsquo;s .viminfo located?<a hidden class=anchor aria-hidden=true href=#5-where-is-neovims-viminfo-located>#</a></h3><p>vim 的历史命令文件位于 ~/.viminfo ，而 neovim 的位于</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>~/local/share/nvim/shada/main.shada
</span></span></code></pre></td></tr></table></div></div><p>👉 <a href=https://www.reddit.com/r/neovim/comments/5con51/where_is_neovims_viminfo_located/>https://www.reddit.com/r/neovim/comments/</a></p></br><h3 id=6-设置-netrw-的工作目录root-dir>6. 设置 netrw 的工作目录(root dir)<a hidden class=anchor aria-hidden=true href=#6-设置-netrw-的工作目录root-dir>#</a></h3><p>How to set selected directory as current in vim (netrw)? 只需要把光标放在 netrw 里面你想设置的目录下面，然后执行 :Ntree 命令就行</p><p>👉 <a href=https://stackoverflow.com/questions/33542513/how-to-set-selected-directory-as-current-in-vim-netrw>https://stackoverflow.com/questions/33542513/</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://hcy-asleep.github.io/tags/VIM/>VIM</a></li></ul><nav class=paginav><a class=prev href=https://hcy-asleep.github.io/%E4%B8%BA-xv6-riscv-%E7%A7%BB%E6%A4%8D%E6%89%AB%E9%9B%B7minesweeper-2048-%E4%BB%A5%E5%8F%8A%E9%9D%9E%E5%B8%B8%E7%AE%80%E5%8D%95%E7%9A%84-sl/><span class=title>« 上一页</span><br><span>为 xv6-riscv 移植扫雷(minesweeper) 2048 以及非常简单的 sl</span>
</a><a class=next href=https://hcy-asleep.github.io/Git-%E5%88%97%E5%87%BA%E9%99%A4%E4%BA%86-.gitignore-%E4%BB%A5%E5%A4%96%E7%9A%84%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6%E5%8C%85%E6%8B%AC-tracked-%E5%92%8C-untracked-%E7%9A%84/><span class=title>下一页 »</span><br><span>Git 列出除了 .gitignore 以外的所有文件（包括 tracked 和 untracked 的）</span></a></nav></footer></br></br><script src=https://giscus.app/client.js data-repo=HCY-ASLEEP/HCY-ASLEEP.github.io data-repo-id=R_kgDOISFjNg data-category=Announcements data-category-id=DIC_kwDOISFjNs4CUJyb data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=zh-CN crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2024 <a href=https://hcy-asleep.github.io/>Memos</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>