<!doctype html><html lang=zh dir=auto><head><meta name=generator content="Hugo 0.139.3"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Memos</title>
<meta name=keywords content="Blog,Portfolio,PaperMod"><meta name=description content="Welcome"><meta name=author content="HCY"><link rel=canonical href=https://hcy-asleep.github.io/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bbe7c693ba1e57651eda5c9f7653fe0f608bca43c4b67d413bde2747e48dd912.css integrity="sha256-u+fGk7oeV2Ue2lyfdlP+D2CLykPEtn1BO94nR+SN2RI=" rel="preload stylesheet" as=style><link rel=icon href=https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png><link rel=icon type=image/png sizes=16x16 href=https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png><link rel=icon type=image/png sizes=32x32 href=https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png><link rel=apple-touch-icon href=https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png><link rel=mask-icon href=https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://hcy-asleep.github.io/index.xml><link rel=alternate type=application/json href=https://hcy-asleep.github.io/index.json><link rel=alternate hreflang=zh href=https://hcy-asleep.github.io/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><style>@media screen and (min-width:1px){.post-content input[type=checkbox]:checked~label>img{transform:scale(1.6);cursor:zoom-out;position:relative;z-index:999}.post-content img.zoomCheck{transition:transform .15s ease;z-index:999;cursor:zoom-in}}</style><meta property="og:title" content="Memos"><meta property="og:description" content="Welcome"><meta property="og:type" content="website"><meta property="og:url" content="https://hcy-asleep.github.io/"><meta property="og:image" content="https://hcy-asleep.github.io/"><meta property="og:site_name" content="HCY-BLOGS"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://hcy-asleep.github.io/"><meta name=twitter:title content="Memos"><meta name=twitter:description content="Welcome"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"Memos","url":"https://hcy-asleep.github.io/","description":"Welcome","thumbnailUrl":"https://raw.githubusercontent.com/HCY-ASLEEP/picture-bed/main/picture-bed/hcy_site_favicon.png","sameAs":["https://github.com/HCY-ASLEEP","mailto:2420066864@qq.com"]}</script></head><body class=list id=top><header class=header><nav class=nav><div class=logo><a href=https://hcy-asleep.github.io/ accesskey=h title="ä¸»é¡µ (Alt + H)">ä¸»é¡µ</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://hcy-asleep.github.io/archives/ title=å½’æ¡£><span>å½’æ¡£</span></a></li><li><a href=https://hcy-asleep.github.io/tags/ title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=https://hcy-asleep.github.io/categories/ title=ç›®å½•><span>ç›®å½•</span></a></li><li><a href=https://hcy-asleep.github.io/friends/ title=å‹é“¾><span>å‹é“¾</span></a></li><li><a href=https://hcy-asleep.github.io/todo/ title=TODO><span>TODO</span></a></li><li><a href=https://hcy-asleep.github.io/about/ title=å…³äº><span>å…³äº</span></a></li><li><a href=https://hcy-asleep.github.io/search/ title="ğŸ” (Alt + /)" accesskey=/><span>ğŸ”</span></a></li></ul></nav></header><main class=main><article class="first-entry home-info"><header class=entry-header><h1>HÊŒllo~ ğŸ‘‹</h1></header><div class=entry-content>Welcome to my blog</div><footer class=entry-footer><div class=social-icons><a href=https://github.com/HCY-ASLEEP target=_blank rel="noopener noreferrer me" title=Github><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a><a href=mailto:2420066864@qq.com target=_blank rel="noopener noreferrer me" title=Email><svg viewBox="0 0 24 21" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></div></footer></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Linux è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼ˆè™šæ‹Ÿå†…å­˜æ–‡ä»¶ç³»ç»Ÿï¼‰ä»¥åŠå…±äº«å†…å­˜åŸç†</h2></header><div class=entry-content><p>æœ€è¿‘çœ‹äº†ã€ŠUnderstanding the LinuxÂ® Virtual Memory Managerã€‹é‡Œé¢çš„ç¬¬åäºŒç«  SHARED MEMORY VIRTUAL FILESYSTEM ï¼Œå¯¹æ–‡ä»¶ç³»ç»Ÿä»¥åŠå†…å­˜æ–‡ä»¶ç®¡ç†æœ‰äº†æ›´åŠ æ·±å…¥çš„äº†è§£ï¼Œä¸‹é¢æ˜¯çœ‹äº†è¿™ä¸€ç« èŠ‚ä¹‹åå¯¹å…¶ä¸­ä¸€äº›æ¦‚å¿µçš„ç†è§£ä»¥åŠæ‹“å±•ï¼Œè¦æ˜¯æƒ³äº†è§£è¿™ä¸€ç« ï¼Œå»ºè®®è¯»åŸæ–‡ï¼Œé…åˆè¿™ç¯‡åšå®¢è¾…åŠ©ç†è§£
Linux å“²å­¦ åœ¨ Linux é‡Œé¢ï¼Œä¸€åˆ‡çš†æ–‡ä»¶ï¼Œæ‰€æœ‰çš„ä¸œè¥¿éƒ½å¯ä»¥çœ‹ä½œä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œå‡¡æ˜¯æ–‡ä»¶ï¼Œéƒ½åº”è¯¥æ”¯æŒPOSIXæ–‡ä»¶æ“ä½œï¼ˆæ¯”å¦‚ read() ï¼Œwrite() ï¼Œopen()ï¼‰ æ¯ä¸€å—å†…å­˜å¯¹è±¡ï¼Œéƒ½å¯ä»¥è¢«çœ‹ä½œä¸€ä¸ªæ–‡ä»¶ï¼Œä¸€æ—¦èµ‹äºˆè¿™å—å†…å­˜å¯¹è±¡ç›¸å¯¹åº”çš„æ–‡ä»¶æè¿°ï¼Œå°±å¯ä»¥ä½¿ç”¨åƒä½¿ç”¨æ™®é€šæ–‡ä»¶é‚£æ ·å­æ“ä½œå†…å­˜å¯¹è±¡ è€Œè¿™ä¹Ÿæ­£æ˜¯ VFSï¼ˆè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ virtual file system ï¼ŒåŒ…æ‹¬å†…å­˜æ–‡ä»¶ç³»ç»Ÿä»¥åŠå…±äº«å†…å­˜ç®¡ç†ç³»ç»Ÿï¼‰çš„è®¾è®¡ç†å¿µä»¥åŠå®ç°æ–¹å‘ VMAï¼ˆvirtual memory areaï¼‰ Linux å†…æ ¸ç”¨vm_area_structç»“æ„ä½“æè¿°æŸä¸€æ®µè¿ç»­çš„è™šæ‹Ÿå†…å­˜åŒºåŸŸVMAï¼ˆvirtual memory areaï¼‰ï¼Œæ¯ä¸ªè™šæ‹Ÿå†…å­˜åŒºåŸŸ VMA éƒ½æœ‰è‡ªå·±çš„vm_area_struct ç»“æ„ä½“
å†…å­˜æè¿°ç¬¦ mm_struct æŒ‡å‘è¿›ç¨‹çš„æ•´ä¸ªåœ°å€ç©ºé—´ï¼Œvm_area_struct åªæ˜¯æŒ‡å‘äº†è™šæ‹Ÿç©ºé—´çš„ä¸€æ®µï¼Œè¿™å—è™šæ‹Ÿå†…å­˜åŒºåŸŸVMAçš„åœ°å€èŒƒå›´ä¸º [vm_start, vm_end) ï¼Œå·¦å¼€å³é—­ vm_area_struct æ˜¯ç”±åŒå‘é“¾è¡¨é“¾æ¥èµ·æ¥çš„ï¼Œå®ƒä»¬æ˜¯æŒ‰ç…§è™šæ‹Ÿåœ°å€é™åºæ’åºçš„ï¼Œæ¯ä¸ªè¿™æ ·çš„ç»“æ„éƒ½å¯¹åº”æè¿°ä¸€ä¸ªåœ°å€ç©ºé—´èŒƒå›´
ä¸ºäº†å¿«é€Ÿæ ¹æ®åœ°å€æ‰¾åˆ°å¯¹åº”çš„ VMAï¼Œå†…æ ¸å¯¹å…¶å»ºç«‹äº†çº¢é»‘æ ‘ç´¢å¼•ï¼Œçº¢é»‘æ ‘çš„æ¯ä¸ªå¶å­ç»“ç‚¹å°±æ˜¯ä¸€ä¸ªVMAåŒºåŸŸï¼Œå¼•å…¥çº¢é»‘æ ‘çš„å¥½å¤„æ˜¯å¯ä»¥æé«˜æŸ¥æ‰¾VMAçš„æ•ˆç‡ï¼ˆå³ä¾¿VMAçš„æ•°é‡ç¿»å€ï¼ŒVMAçš„æŸ¥æ‰¾æ¬¡æ•°ä¹Ÿåªå¢åŠ ä¸€æ¬¡ï¼‰ ä¹‹æ‰€ä»¥è¿™æ ·åˆ†éš”æ˜¯å› ä¸ºæ¯ä¸ªè™šæ‹ŸåŒºé—´å¯èƒ½æ¥æºä¸åŒï¼Œæœ‰çš„å¯èƒ½æ¥è‡ªå¯æ‰§è¡Œæ˜ åƒï¼Œæœ‰çš„å¯èƒ½æ¥è‡ªå…±äº«åº“ï¼Œè€Œæœ‰çš„å¯èƒ½æ˜¯åŠ¨æ€å†…å­˜åˆ†é…çš„å†…å­˜åŒºï¼Œæ‰€ä»¥å¯¹äºæ¯ä¸ªç”± vm_area_struct ç»“æ„æ‰€æè¿°çš„åŒºé—´çš„å¤„ç†æ“ä½œå’Œå®ƒå‰åèŒƒå›´çš„å¤„ç†æ“ä½œä¸åŒï¼Œå› æ­¤ linux æŠŠè™šæ‹Ÿå†…å­˜åˆ†å‰²ç®¡ç†ï¼Œå¹¶åˆ©ç”¨äº†è™šæ‹Ÿå†…å­˜å¤„ç†ä¾‹ç¨‹ vm_ops æ¥æŠ½è±¡å¯¹ä¸åŒæ¥æºè™šæ‹Ÿå†…å­˜çš„å¤„ç†æ–¹æ³•
ä¸åŒçš„è™šæ‹ŸåŒºé—´å…¶å¤„ç†æ“ä½œå¯èƒ½ä¸åŒï¼Œlinux åœ¨è¿™é‡Œåˆ©ç”¨äº†é¢å‘å¯¹è±¡çš„æ€æƒ³ï¼Œå³æŠŠä¸€ä¸ªè™šæ‹ŸåŒºé—´çœ‹æˆæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨ vm_area_struct æè¿°è¿™ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œå…¶ä¸­çš„ vm_operation ç»“æ„æè¿°äº†åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šçš„æ“ä½œ è™šæ‹Ÿå†…å­˜ç©ºé—´ç®¡ç†æ¦‚æ‹¬å›¾ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 # https://elixir.bootlin.com/linux/v2.6.0/source/include/linux/mm.h#L51 struct vm_area_struct { struct mm_struct * vm_mm; /* The address space we belong to. */ unsigned long vm_start; /* Our start address within vm_mm. */ unsigned long vm_end; /* The first byte after our end address within vm_mm. */ /* linked list of VM areas per task, sorted by address */ struct vm_area_struct *vm_next; pgprot_t vm_page_prot; /* Access permissions of this VMA. */ unsigned long vm_flags; /* Flags, listed below. */ struct rb_node vm_rb; /* * For areas with an address space and backing store, * one of the address_space->i_mmap{,shared} lists, * for shm areas, the list of attaches, otherwise unused. */ struct list_head shared; /* Function pointers to deal with this struct. */ struct vm_operations_struct * vm_ops; /* Information about our backing store: */ unsigned long vm_pgoff; /* Offset (within vm_file) in PAGE_SIZE units, *not* PAGE_CACHE_SIZE */ struct file * vm_file; /* File we map to (can be NULL). */ void * vm_private_data; /* was vm_pte (shared mem) */ }; struct address_space çœ‹ linux å†…æ ¸å¾ˆå®¹æ˜“è¢« struct address_space è¿™ä¸ªç»“æ„è¿·æƒ‘ï¼Œå®ƒæ˜¯ä»£è¡¨æŸä¸ªåœ°å€ç©ºé—´å—ï¼Ÿå®é™…ä¸Šä¸æ˜¯çš„ï¼Œå®ƒæ˜¯ç”¨äºç®¡ç†æ–‡ä»¶ struct inode æ˜ å°„åˆ°å†…å­˜çš„é¡µé¢ struct page çš„ï¼Œå…¶å®å°±æ˜¯æ¯ä¸ª file éƒ½æœ‰è¿™ä¹ˆä¸€ä¸ªç»“æ„ï¼Œå°†æ–‡ä»¶ç³»ç»Ÿä¸­è¿™ä¸ª file å¯¹åº”çš„æ•°æ®ä¸è¿™ä¸ª file å¯¹åº”çš„å†…å­˜ç»‘å®šåˆ°ä¸€èµ· ä¸ä¹‹å¯¹åº”ï¼Œaddress_space_operations å°±æ˜¯ç”¨æ¥æ“ä½œè¯¥æ–‡ä»¶æ˜ å°„åˆ°å†…å­˜çš„é¡µé¢ï¼Œæ¯”å¦‚æŠŠå†…å­˜ä¸­çš„ä¿®æ”¹å†™å›æ–‡ä»¶ã€ä»æ–‡ä»¶ä¸­è¯»å…¥æ•°æ®åˆ°é¡µé¢ç¼“å†²ç­‰ ä¸€ä¸ªå…·ä½“çš„æ–‡ä»¶åœ¨æ‰“å¼€åï¼Œå†…æ ¸ä¼šåœ¨å†…å­˜ä¸­ä¸ºä¹‹å»ºç«‹ä¸€ä¸ª struct inode ç»“æ„ï¼ˆè¯¥ inode ç»“æ„ä¹Ÿä¼šåœ¨å¯¹åº”çš„ file ç»“æ„ä½“ä¸­å¼•ç”¨ï¼‰ï¼Œå…¶ä¸­çš„ i_mapping åŸŸæŒ‡å‘ä¸€ä¸ª address_space ç»“æ„ ä¸€ä¸ªæ–‡ä»¶å°±å¯¹åº”ä¸€ä¸ª address_space ç»“æ„ï¼Œä¸€ä¸ª address_space ä¸ä¸€ä¸ªåç§»é‡èƒ½å¤Ÿç¡®å®šä¸€ä¸ª page cache æˆ– swap cache ä¸­çš„ä¸€ä¸ªé¡µé¢ï¼Œå½“è¦å¯»å€æŸä¸ªæ•°æ®æ—¶ï¼Œå¾ˆå®¹æ˜“æ ¹æ®ç»™å®šçš„æ–‡ä»¶åŠæ•°æ®åœ¨æ–‡ä»¶å†…çš„åç§»é‡è€Œæ‰¾åˆ°ç›¸åº”çš„é¡µé¢ struct file å’Œ struct inode ç»“æ„ä½“ä¸­éƒ½æœ‰ä¸€ä¸ª struct address_space æŒ‡é’ˆï¼Œå®é™…ä¸Šï¼Œfile -> f_mapping æ˜¯ä»å¯¹åº” inode -> i_mapping è€Œæ¥, inode -> i_mapping -> a_ops æ˜¯ç”±å¯¹åº”çš„æ–‡ä»¶ç³»ç»Ÿç±»å‹åœ¨ç”Ÿæˆè¿™ä¸ª inode æ—¶èµ‹äºˆçš„ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 # https://elixir.bootlin.com/linux/v2.6.0/source/include/linux/fs.h#L319 struct address_space { struct inode *host; /* owner: inode, block_device */ struct radix_tree_root page_tree; /* radix tree of all pages */ spinlock_t page_lock; /* and spinlock protecting it */ struct list_head clean_pages; /* list of clean pages */ struct list_head dirty_pages; /* list of dirty pages */ struct list_head locked_pages; /* list of locked pages */ struct list_head io_pages; /* being prepared for I/O */ unsigned long nrpages; /* number of total pages */ struct address_space_operations *a_ops; /* methods */ struct list_head i_mmap; /* list of private mappings */ struct list_head i_mmap_shared; /* list of shared mappings */ struct semaphore i_shared_sem; /* protect both above lists */ atomic_t truncate_count; /* Cover race condition with truncate */ unsigned long dirtied_when; /* jiffies of first page dirtying */ unsigned long flags; /* error bits/gfp mask */ struct backing_dev_info *backing_dev_info; /* device readahead, etc */ spinlock_t private_lock; /* for use by the address_space */ struct list_head private_list; /* ditto */ struct address_space *assoc_mapping; /* ditto */ }; æ–‡ä»¶ç³»ç»Ÿã€æ–‡ä»¶ç±»å‹ã€page çš„åˆ’åˆ† ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œåœ¨æ­¤å°†æ–‡ä»¶ç³»ç»Ÿåˆ’åˆ†ä¸ºå†…å­˜æ–‡ä»¶ç³»ç»Ÿï¼ˆè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼‰ä¸ç¡¬ç›˜æ–‡ä»¶ç³»ç»Ÿï¼ˆç‰©ç†æ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œåœ¨ä¹¦çš„è¿™ä¸€ç« èŠ‚é‡Œé¢ï¼Œä¹Ÿå°†å¹¿ä¹‰ä¸Šçš„æ–‡ä»¶åˆ†ä¸º virtual file å’Œ physics file åœ¨ä¹¦çš„è¿™ä¸€ç« èŠ‚é‡Œé¢ï¼Œå°†å†…å­˜é¡µé¢ page åˆ’åˆ†ä¸º anonymous pages ï¼ˆæ²¡æœ‰ç‰©ç†æ–‡ä»¶æ”¯æŒçš„å†…å­˜é¡µé¢ï¼‰ä¸ pages backed by a fileï¼ˆç”±ç‰©ç†æ–‡ä»¶æ˜ å°„åˆ°å†…å­˜çš„æŸäº› pagesï¼‰ page cache ä¸ swap cache page cache æ˜¯ä¸æ–‡ä»¶æ˜ å°„å¯¹åº”çš„ï¼Œè€Œ swap cache æ˜¯ä¸åŒ¿åé¡µå¯¹åº”çš„ å¦‚æœä¸€ä¸ªå†…å­˜é¡µé¢ä¸æ˜¯æ–‡ä»¶æ˜ å°„ï¼Œåˆ™åœ¨æ¢å…¥æ¢å‡ºçš„æ—¶å€™åŠ å…¥åˆ° swap cache ï¼Œå¦‚æœæ˜¯æ–‡ä»¶æ˜ å°„ï¼Œåˆ™ä¸éœ€è¦äº¤æ¢ç¼“å†² è¿™ä¸¤ä¸ªçš„ç›¸åŒç‚¹å°±æ˜¯å®ƒä»¬éƒ½æ˜¯ address_space ï¼Œéƒ½æœ‰ç›¸å¯¹åº”çš„æ–‡ä»¶æ“ä½œï¼šä¸€ä¸ªè¢«è®¿é—®çš„æ–‡ä»¶çš„ç‰©ç†é¡µé¢éƒ½é©»ç•™åœ¨ page cache æˆ– swap cache ä¸­ï¼Œä¸€ä¸ªé¡µé¢çš„æ‰€æœ‰ä¿¡æ¯ç”± struct page æ¥æè¿° ä¸€èˆ¬æƒ…å†µä¸‹ç”¨æˆ·è¿›ç¨‹è°ƒç”¨ mmap() æ—¶ï¼Œåªæ˜¯åœ¨è¿›ç¨‹ç©ºé—´å†…æ–°å¢äº†ä¸€å—ç›¸åº”å¤§å°çš„ç¼“å†²åŒºï¼Œå¹¶è®¾ç½®äº†ç›¸åº”çš„è®¿é—®æ ‡è¯†ï¼Œä½†å¹¶æ²¡æœ‰å»ºç«‹è¿›ç¨‹ç©ºé—´åˆ°ç‰©ç†é¡µé¢çš„æ˜ å°„ å› æ­¤ï¼Œç¬¬ä¸€æ¬¡è®¿é—®è¯¥ç©ºé—´æ—¶ï¼Œä¼šå¼•å‘ä¸€ä¸ªç¼ºé¡µå¼‚å¸¸ã€‚å¯¹äºå…±äº«å†…å­˜æ˜ å°„æƒ…å†µï¼Œç¼ºé¡µå¼‚å¸¸å¤„ç†ç¨‹åºé¦–å…ˆåœ¨ swap cache ä¸­å¯»æ‰¾ç›®æ ‡é¡µï¼ˆç¬¦åˆ address_space ä»¥åŠåç§»é‡çš„ç‰©ç†é¡µï¼‰ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œåˆ™ç›´æ¥è¿”å›åœ°å€ï¼›å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™åˆ¤æ–­è¯¥é¡µæ˜¯å¦åœ¨äº¤æ¢åŒº (swap area)ï¼Œå¦‚æœåœ¨ï¼Œåˆ™æ‰§è¡Œä¸€ä¸ªæ¢å…¥æ“ä½œï¼›å¦‚æœä¸Šè¿°ä¸¤ç§æƒ…å†µéƒ½ä¸æ»¡è¶³ï¼Œå¤„ç†ç¨‹åºå°†åˆ†é…æ–°çš„ç‰©ç†é¡µé¢ï¼Œå¹¶æŠŠå®ƒæ’å…¥åˆ° page cache ä¸­ï¼Œç¨‹æœ€ç»ˆå°†æ›´æ–°è¿›ç¨‹é¡µè¡¨ å¯¹äºæ˜ å°„æ™®é€šæ–‡ä»¶æƒ…å†µï¼ˆéå…±äº«æ˜ å°„ï¼‰ï¼Œç¼ºé¡µå¼‚å¸¸å¤„ç†ç¨‹åºé¦–å…ˆä¼šåœ¨ page cache ä¸­æ ¹æ® address_space ä»¥åŠæ•°æ®åç§»é‡å¯»æ‰¾ç›¸åº”çš„é¡µé¢ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™è¯´æ˜æ–‡ä»¶æ•°æ®è¿˜æ²¡æœ‰è¯»å…¥å†…å­˜ï¼Œå¤„ç†ç¨‹åºä¼šä»ç£ç›˜è¯»å…¥ç›¸åº”çš„é¡µé¢ï¼Œå¹¶è¿”å›ç›¸åº”åœ°å€ï¼ŒåŒæ—¶ï¼Œè¿›ç¨‹é¡µè¡¨ä¹Ÿä¼šæ›´æ–° ç¡¬ç›˜æ–‡ä»¶ç³»ç»Ÿ tmpfs å’Œ shm å…±æ€§ä¸åŒºåˆ« tmpfs å’Œ shm éƒ½æ˜¯åŸºäºå†…å­˜çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒä»¬å°†æ–‡ä»¶å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œè€Œä¸æ˜¯ç£ç›˜ä¸Šï¼Œå°½ç®¡å®ƒä»¬æœ‰ä¸€äº›ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†å®ƒä»¬çš„ç”¨é€”ã€é…ç½®æ–¹æ³•ä»¥åŠæ“ä½œä¸Šä¹Ÿæœ‰ä¸€äº›å…³é”®çš„åŒºåˆ«
...</p></div><footer class=entry-footer><span title='2024-11-30 19:35:39 +0000 UTC'>åä¸€æœˆ 30, 2024</span>&nbsp;Â·&nbsp;5 åˆ†é’Ÿ&nbsp;Â·&nbsp;927 å­—&nbsp;Â·&nbsp;HCY</footer><a class=entry-link aria-label="post link to Linux è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼ˆè™šæ‹Ÿå†…å­˜æ–‡ä»¶ç³»ç»Ÿï¼‰ä»¥åŠå…±äº«å†…å­˜åŸç†" href=https://hcy-asleep.github.io/Linux-%E8%99%9A%E6%8B%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%BB%A5%E5%8F%8A%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E5%8E%9F%E7%90%86/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Linuxç£ç›˜å ç”¨åˆ†æ</h2></header><div class=entry-content><p>å‰å‡ å¤©æœåŠ¡å™¨åˆå®•æœºäº†ï¼Œä»”ç»†æ’æŸ¥åŸæ¥æ˜¯ç£ç›˜çš„å ç”¨æ»¡äº†ï¼Œåœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹ä½¿ç”¨åˆ°çš„å‘½ä»¤ä»¥åŠç›¸å…³å°çŸ¥è¯† åœ¨ linux shell é‡Œé¢æŸ¥çœ‹ç£ç›˜å ç”¨ä¿¡æ¯ä¸»è¦æœ‰ä¸¤ä¸ªå‘½ä»¤ï¼Œä¸€ä¸ªæ˜¯ du ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯ df
du å’Œ df çš„åŒºåˆ« du : disk usage
ä¸»è¦ç”¨äºé€’å½’è®¡ç®—æŒ‡å®šæ–‡ä»¶å¤¹çš„å¤§å° å®ƒé€šè¿‡æœç´¢æ–‡ä»¶æ¥è®¡ç®—æ¯ä¸ªæ–‡ä»¶çš„å¤§å°ç„¶åç´¯åŠ ï¼Œåªèƒ½çœ‹åˆ°å½“å‰å­˜åœ¨çš„ï¼Œæ²¡æœ‰è¢«åˆ é™¤çš„æ–‡ä»¶ ä½¿ç”¨ du - sh å¯ä»¥æ˜¾ç¤ºå½“å‰ç›®å½•çš„æ€»ç£ç›˜ä½¿ç”¨é‡ï¼Œå¹¶ä¸”ä»¥æ˜“è¯»çš„æ ¼å¼ï¼ˆå¦‚ Kã€Mã€Gï¼‰æ˜¾ç¤º -s æˆ– --summarizeï¼šåªæ˜¾ç¤ºæ€»è®¡çš„ç£ç›˜ä½¿ç”¨é‡ï¼Œè€Œä¸æ˜¯åˆ—å‡ºæ¯ä¸ªå­ç›®å½•çš„è¯¦ç»†ä½¿ç”¨é‡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä¼šæ˜¾ç¤ºå½“å‰ç›®å½•ï¼ˆæˆ–æŒ‡å®šç›®å½•ï¼‰çš„æ€»å¤§å°ï¼Œè€Œä¸æ˜¯åˆ—å‡ºæ¯ä¸ªå­ç›®å½•çš„å¤§å° -h æˆ– --human-readableï¼šä»¥æ›´æ˜“è¯»çš„æ ¼å¼æ˜¾ç¤ºç£ç›˜ä½¿ç”¨é‡ï¼Œä¾‹å¦‚ä»¥ Kï¼ˆåƒå­—èŠ‚ï¼‰ã€Mï¼ˆå…†å­—èŠ‚ï¼‰ã€Gï¼ˆå‰å­—èŠ‚ï¼‰ç­‰å•ä½æ˜¾ç¤ºï¼Œè€Œä¸æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½ 1 2 hcy@debian:~$ du -sh 6.6G . è€Œ du -h å¯ä»¥æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•çš„å¤§å°,è¿™ä¸ªä¼šé€’å½’åˆ—å‡ºæ‰€æœ‰å­ç›®å½•å ç”¨ä¿¡æ¯ï¼Œå†…å®¹ä¼šéå¸¸å¤š æœ‰äº›æƒ…å†µä¸‹ä¸ºäº†å¯ä»¥è‡ªé¡¶å‘ä¸‹é€å±‚æ–‡ä»¶å¤¹åœ°åˆ†æå“ªäº›ç›®å½•æ˜¯å¯¼è‡´ç£ç›˜è‡ƒè‚¿çš„åŸå› ï¼Œå¯ä»¥ä½¿ç”¨ --max-depth å‚æ•°ï¼Œä¸‹é¢æ˜¯åªé€’å½’å±•ç¤ºä¸€å±‚ï¼ˆç¬¬ä¸€å±‚ï¼‰çš„å ç”¨æƒ…å†µï¼ˆ â€“max-depth 1 ï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 root@xtz:~/build# du -h --max-depth 1 2.7M ./unittests 244K ./cmake 32K ./docs 124K ./share 13G ./bin 32K ./libexec 11M ./test 3.6G ./tools 4.1M ./include 1.5M ./examples 32K ./runtimes 13G ./lib 99M ./utils 150M ./projects 8.9M ./CMakeFiles 30G . ä½†æ˜¯ä½¿ç”¨ du -h --max-depth 1 çš„ç»“æœå¹¶ä¸æ˜¯æŒ‰ç…§ç£ç›˜å ç”¨æƒ…å†µä»å°åˆ°å¤§çš„é¡ºåºæ’åºçš„ï¼Œè¿˜æ˜¯ä¸å¤Ÿç›´è§‚åœ°åˆ†æå ç”¨æƒ…å†µï¼Œäºæ˜¯é€šè¿‡ä½¿ç”¨ sort -rh è¿›è¡Œè¿›ä¸€æ­¥æ’åº 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 root@xtz:~/build# du -h --max-depth 1 | sort -rh 30G . 13G ./lib 13G ./bin 3.6G ./tools 150M ./projects 99M ./utils 11M ./test 8.9M ./CMakeFiles 4.1M ./include 2.7M ./unittests 1.5M ./examples 244K ./cmake 124K ./share 32K ./runtimes 32K ./libexec 32K ./docs å…¶ä¸­ sort ç›®å½•çš„é€‰é¡¹ -r è¡¨ç¤ºé€†åºï¼Œä¸åŠ  -r å°±æ˜¯é¡ºåºï¼›ç”±äºå‰é¢çš„ du ä½¿ç”¨äº† -h é€‰é¡¹ï¼Œæ‰€ä»¥ sort ä¹Ÿè¦å¯ç”¨ -h é€‰é¡¹æ‰å¯ä»¥å’Œ du ç»“æœåŒ¹é…èµ·æ¥è¿›è¡Œæ’åº df : disk free
...</p></div><footer class=entry-footer><span title='2024-11-25 19:27:02 +0000 UTC'>åä¸€æœˆ 25, 2024</span>&nbsp;Â·&nbsp;2 åˆ†é’Ÿ&nbsp;Â·&nbsp;394 å­—&nbsp;Â·&nbsp;HCY</footer><a class=entry-link aria-label="post link to Linuxç£ç›˜å ç”¨åˆ†æ" href=https://hcy-asleep.github.io/Linux%E7%A3%81%E7%9B%98%E5%8D%A0%E7%94%A8%E5%88%86%E6%9E%90/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>SPEC CPU2006å®‰è£…ä½¿ç”¨é¿å‘</h2></header><div class=entry-content><p>å®‰è£… ç½‘ä¸Šæ‰¾åˆ°çš„ç‰ˆæœ¬åº”è¯¥æ˜¯è¿™ä¸ªspeccpu2006-v1.0.1-newest.tarï¼Œåœ¨æƒ³è¦å®‰è£…çš„ç›®å½•ä¸‹æ‰§è¡Œtar -xvf speccpu2006-v1.0.1-newest.tarå°±å¯ä»¥è§£å‹å®‰è£… è¿›å…¥åˆ°ç›®å½•é‡Œé¢cd speccpu2006-v1.0.1 å®‰è£… spec ï¼Œ./install.shï¼Œå¦‚æœå®‰è£…å‡ºç°é”™è¯¯ï¼Œææœ‰å¯èƒ½æ˜¯æœ‰ä¸€äº›æ–‡ä»¶æ²¡æœ‰å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé€’å½’èµ‹äºˆå¯æ‰§è¡Œæ–‡ä»¶å°±è¡Œchmod -R a+x .ï¼Œä¸ä¼šæœ‰é—®é¢˜çš„ å®‰è£…å®Œæˆä¹‹åæ‰§è¡Œ./shrcæ¿€æ´»specç¯å¢ƒï¼ˆä»¥åæ¯æ¬¡é‡æ–°æ‰“å¼€ä¸€ä¸ª shell ä¼šè¯çš„æ—¶å€™éƒ½éœ€è¦æ¿€æ´»ä¸€ä¸‹ï¼‰ æ„æˆ SPECæœ‰ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼Œä¸€ä¸ªæ˜¯æ•°æ®ï¼Œä¸€ä¸ªæ˜¯ä»£ç ï¼ˆä»£ç ä»¥é¡¹ç›®çš„æ–¹å¼ç»„ç»‡ï¼‰ï¼Œè¿è¡Œéœ€è¦æŒ‡å®šæ•°æ®ä»¥åŠé¡¹ç›® æ•°æ®æœ‰ä¸‰ä¸ªè§„æ ¼ testï¼ˆå°å‹ï¼‰ trainï¼ˆä¸­å‹ï¼‰ refï¼ˆå¤§å‹ï¼‰ ä»£ç æœ‰ä»¥ä¸‹é€‰é¡¹ intï¼ˆæ•´å‹è¿ç®—æ€§èƒ½ï¼‰ floatï¼Œä¹Ÿå« fpï¼ˆæµ®ç‚¹è¿ç®—æ€§èƒ½ï¼‰ all_cï¼ˆå…¨éƒ¨ c é¡¹ç›®ï¼‰ all_cppï¼ˆå…¨éƒ¨ cpp é¡¹ç›®ï¼‰ allï¼ˆå…¨éƒ¨é¡¹ç›®ï¼‰ ç‰¹å®šé¡¹ç›®ï¼Œæ¯”å¦‚ 453.povray ç¼–è¯‘æ ‡å‡† C è¯­è¨€è¦ä½¿ç”¨ -std=gnu89 CPP è¦ä½¿ç”¨ -std=c++98 å¦‚æœè¦å¯ç”¨ address sanitizerï¼Œè¦æ³¨æ„é˜²æ­¢ sanitizer æ£€æµ‹åˆ°é”™è¯¯çš„æ—¶å€™ abort ç¨‹åºè€Œå¯¼è‡´ benchmark æå‰ç»ˆæ­¢ï¼Œéœ€è¦ä½¿ç”¨ä»¥ä¸‹ç¼–è¯‘é€‰é¡¹ 1 -fsanitize=address -fsanitize-recover=address å¹¶ä¸”è¦æ³¨å…¥ç¯å¢ƒå˜é‡ASAN_OPTIONS=halt_on_error=0:detect_leaks=0 é…åˆ¶ è¿è¡Œ spec éœ€è¦æŒ‡å®šé…åˆ¶ï¼Œåœ¨é…åˆ¶æ–‡ä»¶é‡Œé¢è¦å£°æ˜ reportable = 1 æ‰å¯ä»¥æœ‰ç»“æœè¾“å‡º
è¿è¡Œæ¨¡å¼ spec æœ‰ä¸¤ç§è¿è¡Œæ¨¡å¼ï¼Œä¸€ä¸ªæ˜¯ base ï¼ŒåŸºæœ¬æ¨¡å¼ï¼Œä¸€èˆ¬ä½¿ç”¨è¿™ä¸ªï¼Œä¸€ä¸ªæ˜¯ peak ï¼Œæ€§èƒ½æ¨¡å¼ï¼Œæµ‹è¯•å³°å€¼æ€§èƒ½æé™
...</p></div><footer class=entry-footer><span title='2024-11-17 21:34:26 +0000 UTC'>åä¸€æœˆ 17, 2024</span>&nbsp;Â·&nbsp;9 åˆ†é’Ÿ&nbsp;Â·&nbsp;1762 å­—&nbsp;Â·&nbsp;HCY</footer><a class=entry-link aria-label="post link to SPEC CPU2006å®‰è£…ä½¿ç”¨é¿å‘" href=https://hcy-asleep.github.io/SPEC-CPU2006%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E9%81%BF%E5%9D%91/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Online LaTex2HTML Converter By Mathjax</h2></header><div class=entry-content><p>Enter LaTeX Formula ğŸ‘‡ Generated HTML Code ğŸ‘‡ ğŸ–±ï¸ğŸ‘‰ copy code ğŸ‘ˆğŸ–±ï¸</p></div><footer class=entry-footer><span title='2024-11-08 14:44:13 +0000 UTC'>åä¸€æœˆ 8, 2024</span>&nbsp;Â·&nbsp;1 åˆ†é’Ÿ&nbsp;Â·&nbsp;12 å­—&nbsp;Â·&nbsp;HCY</footer><a class=entry-link aria-label="post link to Online LaTex2HTML Converter By Mathjax" href=https://hcy-asleep.github.io/Online-LaTex2HTML-Converter-By-Mathjax/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>æ€§èƒ½åˆ†æå¤‡å¿˜å½•</h2></header><div class=entry-content><p>Perf Debian å®‰è£… perf 1 sudo apt install linux-perf æ”¶é›†åˆ†æ”¯é¢„æµ‹äº‹ä»¶ 1 perf stat -e branch-instructions,branch-misses &lt;your_program> branch-instructionsï¼šåˆ†æ”¯æŒ‡ä»¤çš„æ€»æ•° branch-missesï¼šåˆ†æ”¯é¢„æµ‹å¤±è´¥çš„æ¬¡æ•° 1 hit_rate = 1 - branch-misses / branch-instructions //å‘½ä¸­ç‡ ä»¥ä¸‹æ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªå¤æ‚åˆ†æ”¯è·³è½¬çš„ C è¯­è¨€ç¨‹åºç¤ºä¾‹ã€‚è¿™ä¸ªç¨‹åºåŒ…å«äº†å¤šå±‚åµŒå¥—çš„æ¡ä»¶åˆ¤æ–­ã€å¾ªç¯å’Œå‡½æ•°è°ƒç”¨ï¼Œä»¥æ¼”ç¤ºå¤æ‚çš„åˆ†æ”¯é€»è¾‘
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 #include &lt;stdio.h> #include &lt;stdlib.h> #include &lt;time.h> // æ¨¡æ‹Ÿå¤æ‚æ¡ä»¶çš„å‡½æ•° int complex_condition(int x) { if (x % 2 == 0) { if (x % 3 == 0) { return 1; // å¯è¢«2å’Œ3æ•´é™¤ } else { if (x % 5 == 0) { return 2; // å¯è¢«2å’Œ5æ•´é™¤ } else { return 3; // å¯è¢«2æ•´é™¤ï¼Œä½†ä¸èƒ½è¢«3æˆ–5æ•´é™¤ } } } else { if (x % 7 == 0) { return 4; // å¯è¢«7æ•´é™¤ } else { return 5; // ä¸èƒ½è¢«2æˆ–7æ•´é™¤ } } } // é€’å½’å‡½æ•°ï¼Œæ¨¡æ‹Ÿå¤æ‚çš„åˆ†æ”¯è·³è½¬ int recursive_function(int depth) { if (depth &lt;= 0) { return 0; } else { if (depth % 2 == 0) { return depth * recursive_function(depth - 1); } else { return depth + recursive_function(depth - 1); } } } // ä¸»å‡½æ•°ï¼ŒåŒ…å«å¤šé‡å¾ªç¯å’Œåˆ†æ”¯åˆ¤æ–­ int main() { srand(time(NULL)); // ç”¨å½“å‰æ—¶é—´ä½œä¸ºéšæœºæ•°ç§å­ // æ¨¡æ‹Ÿåˆ†æ”¯è·³è½¬ for (int i = 0; i &lt; 20; i++) { int rand_num = rand() % 100 + 1; // ç”Ÿæˆ1åˆ°100ä¹‹é—´çš„éšæœºæ•° int result = complex_condition(rand_num); switch (result) { case 1: printf("Number %d is divisible by 2 and 3.\n", rand_num); break; case 2: printf("Number %d is divisible by 2 and 5.\n", rand_num); break; case 3: printf("Number %d is divisible by 2, but not by 3 or 5.\n", rand_num); break; case 4: printf("Number %d is divisible by 7.\n", rand_num); break; case 5: printf("Number %d is not divisible by 2 or 7.\n", rand_num); break; default: printf("Unexpected result for number %d.\n", rand_num); break; } } // é€’å½’è°ƒç”¨ï¼Œæ¨¡æ‹Ÿæ›´å¤æ‚çš„åˆ†æ”¯ int depth = rand() % 10 + 1; printf("\nRecursive function result for depth %d: %d\n", depth, recursive_function(depth)); return 0; } ç¼–è¯‘ä¹‹åï¼Œä½¿ç”¨ perf è¿›è¡Œåˆ†æ”¯é¢„æµ‹äº‹ä»¶ç»Ÿè®¡å¾—åˆ°ç»“æœï¼š
...</p></div><footer class=entry-footer><span title='2024-11-06 17:31:59 +0000 UTC'>åä¸€æœˆ 6, 2024</span>&nbsp;Â·&nbsp;6 åˆ†é’Ÿ&nbsp;Â·&nbsp;1105 å­—&nbsp;Â·&nbsp;HCY</footer><a class=entry-link aria-label="post link to æ€§èƒ½åˆ†æå¤‡å¿˜å½•" href=https://hcy-asleep.github.io/%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E5%A4%87%E5%BF%98%E5%BD%95/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://hcy-asleep.github.io/page/2/>ä¸‹ä¸€é¡µ&nbsp;&nbsp;Â»</a></nav></footer></main><footer class=footer><span>&copy; 2024 <a href=https://hcy-asleep.github.io/>Memos</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>